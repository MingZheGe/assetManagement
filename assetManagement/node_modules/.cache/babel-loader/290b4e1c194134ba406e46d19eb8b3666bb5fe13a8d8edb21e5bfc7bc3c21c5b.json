{"ast":null,"code":"require(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.array.unshift.js\");\nrequire(\"core-js/modules/web.dom-exception.stack.js\");\n/**\n * @license BSD\n * @copyright 2014-2023 hizzgdev@163.com\n *\n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\n;\n(function ($w) {\n  'use strict';\n\n  console.warn(\"The version is outdated. see details: https://hizzgdev.github.io/jsmind/es6/README.md\");\n  // set 'jsMind' as the library name.\n  // __name__ should be a const value, Never try to change it easily.\n  var __name__ = 'jsMind';\n  // library version\n  var __version__ = '0.5.7';\n  // author\n  var __author__ = 'hizzgdev@163.com';\n\n  // an noop function define\n  var _noop = function () {};\n  var logger = typeof console === 'undefined' ? {\n    log: _noop,\n    debug: _noop,\n    error: _noop,\n    warn: _noop,\n    info: _noop\n  } : console;\n\n  // check global variables\n  if (typeof module === 'undefined' || !module.exports) {\n    if (typeof $w[__name__] != 'undefined') {\n      logger.log(__name__ + ' has been already exist.');\n      return;\n    }\n  }\n\n  // shortcut of methods in dom\n  var $d = $w.document;\n  var $g = function (id) {\n    return $d.getElementById(id);\n  };\n  var $c = function (tag) {\n    return $d.createElement(tag);\n  };\n  var $t = function (n, t) {\n    if (n.hasChildNodes()) {\n      n.firstChild.nodeValue = t;\n    } else {\n      n.appendChild($d.createTextNode(t));\n    }\n  };\n  var $h = function (n, t) {\n    if (t instanceof HTMLElement) {\n      n.innerHTML = '';\n      n.appendChild(t);\n    } else {\n      n.innerHTML = t;\n    }\n  };\n  // detect isElement\n  var $i = function (el) {\n    return !!el && typeof el === 'object' && el.nodeType === 1 && typeof el.style === 'object' && typeof el.ownerDocument === 'object';\n  };\n  if (typeof String.prototype.startsWith != 'function') {\n    String.prototype.startsWith = function (p) {\n      return this.slice(0, p.length) === p;\n    };\n  }\n  var DEFAULT_OPTIONS = {\n    container: '',\n    // id of the container\n    editable: false,\n    // you can change it in your options\n    theme: null,\n    mode: 'full',\n    // full or side\n    support_html: true,\n    view: {\n      engine: 'canvas',\n      hmargin: 100,\n      vmargin: 50,\n      line_width: 2,\n      line_color: '#555',\n      draggable: false,\n      // drag the mind map with your mouse, when it's larger that the container\n      hide_scrollbars_when_draggable: false,\n      // hide container scrollbars, when mind map is larger than container and draggable option is true.\n      node_overflow: 'hidden' // hidden or wrap\n    },\n\n    layout: {\n      hspace: 30,\n      vspace: 20,\n      pspace: 13,\n      cousin_space: 0\n    },\n    default_event_handle: {\n      enable_mousedown_handle: true,\n      enable_click_handle: true,\n      enable_dblclick_handle: true,\n      enable_mousewheel_handle: true\n    },\n    shortcut: {\n      enable: true,\n      handles: {},\n      mapping: {\n        addchild: [45, 4096 + 13],\n        // Insert, Ctrl+Enter\n        addbrother: 13,\n        // Enter\n        editnode: 113,\n        // F2\n        delnode: 46,\n        // Delete\n        toggle: 32,\n        // Space\n        left: 37,\n        // Left\n        up: 38,\n        // Up\n        right: 39,\n        // Right\n        down: 40 // Down\n      }\n    }\n  };\n\n  // core object\n  var jm = function (options) {\n    jm.current = this;\n    this.version = __version__;\n    var opts = {};\n    jm.util.json.merge(opts, DEFAULT_OPTIONS);\n    jm.util.json.merge(opts, options);\n    if (!opts.container) {\n      logger.error('the options.container should not be null or empty.');\n      return;\n    }\n    this.options = opts;\n    this.initialized = false;\n    this.mind = null;\n    this.event_handles = [];\n    this.init();\n  };\n\n  // ============= static object =============================================\n  jm.direction = {\n    left: -1,\n    center: 0,\n    right: 1,\n    of: function (dir) {\n      if (!dir || dir === -1 || dir === 0 || dir === 1) {\n        return dir;\n      }\n      if (dir === '-1' || dir === '0' || dir === '1') {\n        return parseInt(dir);\n      }\n      if (dir.toLowerCase() === 'left') {\n        return this.left;\n      }\n      if (dir.toLowerCase() === 'right') {\n        return this.right;\n      }\n      if (dir.toLowerCase() === 'center') {\n        return this.center;\n      }\n    }\n  };\n  jm.event_type = {\n    show: 1,\n    resize: 2,\n    edit: 3,\n    select: 4\n  };\n  jm.key = {\n    meta: 1 << 13,\n    ctrl: 1 << 12,\n    alt: 1 << 11,\n    shift: 1 << 10\n  };\n  jm.node = function (sId, iIndex, sTopic, oData, bIsRoot, oParent, eDirection, bExpanded) {\n    if (!sId) {\n      logger.error('invalid node id');\n      return;\n    }\n    if (typeof iIndex != 'number') {\n      logger.error('invalid node index');\n      return;\n    }\n    if (typeof bExpanded === 'undefined') {\n      bExpanded = true;\n    }\n    this.id = sId;\n    this.index = iIndex;\n    this.topic = sTopic;\n    this.data = oData || {};\n    this.isroot = bIsRoot;\n    this.parent = oParent;\n    this.direction = eDirection;\n    this.expanded = !!bExpanded;\n    this.children = [];\n    this._data = {};\n  };\n  jm.node.compare = function (node1, node2) {\n    // '-1' is alwary the last\n    var r = 0;\n    var i1 = node1.index;\n    var i2 = node2.index;\n    if (i1 >= 0 && i2 >= 0) {\n      r = i1 - i2;\n    } else if (i1 == -1 && i2 == -1) {\n      r = 0;\n    } else if (i1 == -1) {\n      r = 1;\n    } else if (i2 == -1) {\n      r = -1;\n    } else {\n      r = 0;\n    }\n    //logger.debug(i1+' <> '+i2+'  =  '+r);\n    return r;\n  };\n  jm.node.inherited = function (pnode, node) {\n    if (!!pnode && !!node) {\n      if (pnode.id === node.id) {\n        return true;\n      }\n      if (pnode.isroot) {\n        return true;\n      }\n      var pid = pnode.id;\n      var p = node;\n      while (!p.isroot) {\n        p = p.parent;\n        if (p.id === pid) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  jm.node.is_node = function (n) {\n    return !!n && n instanceof jm.node;\n  };\n  jm.node.prototype = {\n    get_location: function () {\n      var vd = this._data.view;\n      return {\n        x: vd.abs_x,\n        y: vd.abs_y\n      };\n    },\n    get_size: function () {\n      var vd = this._data.view;\n      return {\n        w: vd.width,\n        h: vd.height\n      };\n    }\n  };\n  jm.mind = function () {\n    this.name = null;\n    this.author = null;\n    this.version = null;\n    this.root = null;\n    this.selected = null;\n    this.nodes = {};\n  };\n  jm.mind.prototype = {\n    get_node: function (nodeid) {\n      if (nodeid in this.nodes) {\n        return this.nodes[nodeid];\n      } else {\n        logger.warn('the node[id=' + nodeid + '] can not be found');\n        return null;\n      }\n    },\n    set_root: function (nodeid, topic, data) {\n      if (this.root == null) {\n        this.root = new jm.node(nodeid, 0, topic, data, true);\n        this._put_node(this.root);\n        return this.root;\n      } else {\n        logger.error('root node is already exist');\n        return null;\n      }\n    },\n    add_node: function (parent_node, nodeid, topic, data, direction, expanded, idx) {\n      if (!jm.util.is_node(parent_node)) {\n        logger.error('the parent_node ' + parent_node + ' is not a node.');\n        return null;\n      }\n      var node_index = idx || -1;\n      var node = new jm.node(nodeid, node_index, topic, data, false, parent_node, parent_node.direction, expanded);\n      if (parent_node.isroot) {\n        node.direction = direction || jm.direction.right;\n      }\n      if (this._put_node(node)) {\n        parent_node.children.push(node);\n        this._reindex(parent_node);\n      } else {\n        logger.error('fail, the nodeid \\'' + node.id + '\\' has been already exist.');\n        node = null;\n      }\n      return node;\n    },\n    insert_node_before: function (node_before, nodeid, topic, data, direction) {\n      if (!jm.util.is_node(node_before)) {\n        logger.error('the node_before ' + node_before + ' is not a node.');\n        return null;\n      }\n      var node_index = node_before.index - 0.5;\n      return this.add_node(node_before.parent, nodeid, topic, data, direction, true, node_index);\n    },\n    get_node_before: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return null;\n        } else {\n          return this.get_node_before(the_node);\n        }\n      }\n      if (node.isroot) {\n        return null;\n      }\n      var idx = node.index - 2;\n      if (idx >= 0) {\n        return node.parent.children[idx];\n      } else {\n        return null;\n      }\n    },\n    insert_node_after: function (node_after, nodeid, topic, data, direction) {\n      if (!jm.util.is_node(node_after)) {\n        logger.error('the node_after ' + node_after + ' is not a node.');\n        return null;\n      }\n      var node_index = node_after.index + 0.5;\n      return this.add_node(node_after.parent, nodeid, topic, data, direction, true, node_index);\n    },\n    get_node_after: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return null;\n        } else {\n          return this.get_node_after(the_node);\n        }\n      }\n      if (node.isroot) {\n        return null;\n      }\n      var idx = node.index;\n      var brothers = node.parent.children;\n      if (brothers.length > idx) {\n        return node.parent.children[idx];\n      } else {\n        return null;\n      }\n    },\n    move_node: function (node, before_id, parent_id, direction) {\n      if (!jm.util.is_node(node)) {\n        logger.error('the parameter node ' + node + ' is not a node.');\n        return null;\n      }\n      if (!parent_id) {\n        parent_id = node.parent.id;\n      }\n      return this._move_node(node, before_id, parent_id, direction);\n    },\n    _flow_node_direction: function (node, direction) {\n      if (typeof direction === 'undefined') {\n        direction = node.direction;\n      } else {\n        node.direction = direction;\n      }\n      var len = node.children.length;\n      while (len--) {\n        this._flow_node_direction(node.children[len], direction);\n      }\n    },\n    _move_node_internal: function (node, beforeid) {\n      if (!!node && !!beforeid) {\n        if (beforeid == '_last_') {\n          node.index = -1;\n          this._reindex(node.parent);\n        } else if (beforeid == '_first_') {\n          node.index = 0;\n          this._reindex(node.parent);\n        } else {\n          var node_before = !!beforeid ? this.get_node(beforeid) : null;\n          if (node_before != null && node_before.parent != null && node_before.parent.id == node.parent.id) {\n            node.index = node_before.index - 0.5;\n            this._reindex(node.parent);\n          }\n        }\n      }\n      return node;\n    },\n    _move_node: function (node, beforeid, parentid, direction) {\n      if (!!node && !!parentid) {\n        var parent_node = this.get_node(parentid);\n        if (jm.node.inherited(node, parent_node)) {\n          logger.error('can not move a node to its children');\n          return null;\n        }\n        if (node.parent.id != parentid) {\n          // remove from parent's children\n          var sibling = node.parent.children;\n          var si = sibling.length;\n          while (si--) {\n            if (sibling[si].id == node.id) {\n              sibling.splice(si, 1);\n              break;\n            }\n          }\n          node.parent = parent_node;\n          parent_node.children.push(node);\n        }\n        if (node.parent.isroot) {\n          if (direction == jm.direction.left) {\n            node.direction = direction;\n          } else {\n            node.direction = jm.direction.right;\n          }\n        } else {\n          node.direction = node.parent.direction;\n        }\n        this._move_node_internal(node, beforeid);\n        this._flow_node_direction(node);\n      }\n      return node;\n    },\n    remove_node: function (node) {\n      if (!jm.util.is_node(node)) {\n        logger.error('the parameter node ' + node + ' is not a node.');\n        return false;\n      }\n      if (node.isroot) {\n        logger.error('fail, can not remove root node');\n        return false;\n      }\n      if (this.selected != null && this.selected.id == node.id) {\n        this.selected = null;\n      }\n      // clean all subordinate nodes\n      var children = node.children;\n      var ci = children.length;\n      while (ci--) {\n        this.remove_node(children[ci]);\n      }\n      // clean all children\n      children.length = 0;\n      // remove from parent's children\n      var sibling = node.parent.children;\n      var si = sibling.length;\n      while (si--) {\n        if (sibling[si].id == node.id) {\n          sibling.splice(si, 1);\n          break;\n        }\n      }\n      // remove from global nodes\n      delete this.nodes[node.id];\n      // clean all properties\n      for (var k in node) {\n        delete node[k];\n      }\n      // remove it's self\n      node = null;\n      //delete node;\n      return true;\n    },\n    _put_node: function (node) {\n      if (node.id in this.nodes) {\n        logger.warn('the nodeid \\'' + node.id + '\\' has been already exist.');\n        return false;\n      } else {\n        this.nodes[node.id] = node;\n        return true;\n      }\n    },\n    _reindex: function (node) {\n      if (node instanceof jm.node) {\n        node.children.sort(jm.node.compare);\n        for (var i = 0; i < node.children.length; i++) {\n          node.children[i].index = i + 1;\n        }\n      }\n    }\n  };\n  jm.format = {\n    node_tree: {\n      example: {\n        \"meta\": {\n          \"name\": __name__,\n          \"author\": __author__,\n          \"version\": __version__\n        },\n        \"format\": \"node_tree\",\n        \"data\": {\n          \"id\": \"root\",\n          \"topic\": \"jsMind Example\"\n        }\n      },\n      get_mind: function (source) {\n        var df = jm.format.node_tree;\n        var mind = new jm.mind();\n        mind.name = source.meta.name;\n        mind.author = source.meta.author;\n        mind.version = source.meta.version;\n        df._parse(mind, source.data);\n        return mind;\n      },\n      get_data: function (mind) {\n        var df = jm.format.node_tree;\n        var json = {};\n        json.meta = {\n          name: mind.name,\n          author: mind.author,\n          version: mind.version\n        };\n        json.format = 'node_tree';\n        json.data = df._buildnode(mind.root);\n        return json;\n      },\n      _parse: function (mind, node_root) {\n        var df = jm.format.node_tree;\n        var data = df._extract_data(node_root);\n        mind.set_root(node_root.id, node_root.topic, data);\n        if ('children' in node_root) {\n          var children = node_root.children;\n          for (var i = 0; i < children.length; i++) {\n            df._extract_subnode(mind, mind.root, children[i]);\n          }\n        }\n      },\n      _extract_data: function (node_json) {\n        var data = {};\n        for (var k in node_json) {\n          if (k == 'id' || k == 'topic' || k == 'children' || k == 'direction' || k == 'expanded') {\n            continue;\n          }\n          data[k] = node_json[k];\n        }\n        return data;\n      },\n      _extract_subnode: function (mind, node_parent, node_json) {\n        var df = jm.format.node_tree;\n        var data = df._extract_data(node_json);\n        var d = null;\n        if (node_parent.isroot) {\n          d = node_json.direction == 'left' ? jm.direction.left : jm.direction.right;\n        }\n        var node = mind.add_node(node_parent, node_json.id, node_json.topic, data, d, node_json.expanded);\n        if (!!node_json['children']) {\n          var children = node_json.children;\n          for (var i = 0; i < children.length; i++) {\n            df._extract_subnode(mind, node, children[i]);\n          }\n        }\n      },\n      _buildnode: function (node) {\n        var df = jm.format.node_tree;\n        if (!(node instanceof jm.node)) {\n          return;\n        }\n        var o = {\n          id: node.id,\n          topic: node.topic,\n          expanded: node.expanded\n        };\n        if (!!node.parent && node.parent.isroot) {\n          o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n        }\n        if (node.data != null) {\n          var node_data = node.data;\n          for (var k in node_data) {\n            o[k] = node_data[k];\n          }\n        }\n        var children = node.children;\n        if (children.length > 0) {\n          o.children = [];\n          for (var i = 0; i < children.length; i++) {\n            o.children.push(df._buildnode(children[i]));\n          }\n        }\n        return o;\n      }\n    },\n    node_array: {\n      example: {\n        \"meta\": {\n          \"name\": __name__,\n          \"author\": __author__,\n          \"version\": __version__\n        },\n        \"format\": \"node_array\",\n        \"data\": [{\n          \"id\": \"root\",\n          \"topic\": \"jsMind Example\",\n          \"isroot\": true\n        }]\n      },\n      get_mind: function (source) {\n        var df = jm.format.node_array;\n        var mind = new jm.mind();\n        mind.name = source.meta.name;\n        mind.author = source.meta.author;\n        mind.version = source.meta.version;\n        df._parse(mind, source.data);\n        return mind;\n      },\n      get_data: function (mind) {\n        var df = jm.format.node_array;\n        var json = {};\n        json.meta = {\n          name: mind.name,\n          author: mind.author,\n          version: mind.version\n        };\n        json.format = 'node_array';\n        json.data = [];\n        df._array(mind, json.data);\n        return json;\n      },\n      _parse: function (mind, node_array) {\n        var df = jm.format.node_array;\n        var narray = node_array.slice(0);\n        // reverse array for improving looping performance\n        narray.reverse();\n        var root_node = df._extract_root(mind, narray);\n        if (!!root_node) {\n          df._extract_subnode(mind, root_node, narray);\n        } else {\n          logger.error('root node can not be found');\n        }\n      },\n      _extract_root: function (mind, node_array) {\n        var df = jm.format.node_array;\n        var i = node_array.length;\n        while (i--) {\n          if ('isroot' in node_array[i] && node_array[i].isroot) {\n            var root_json = node_array[i];\n            var data = df._extract_data(root_json);\n            var node = mind.set_root(root_json.id, root_json.topic, data);\n            node_array.splice(i, 1);\n            return node;\n          }\n        }\n        return null;\n      },\n      _extract_subnode: function (mind, parent_node, node_array) {\n        var df = jm.format.node_array;\n        var i = node_array.length;\n        var node_json = null;\n        var data = null;\n        var extract_count = 0;\n        while (i--) {\n          node_json = node_array[i];\n          if (node_json.parentid == parent_node.id) {\n            data = df._extract_data(node_json);\n            var d = null;\n            var node_direction = node_json.direction;\n            if (!!node_direction) {\n              d = node_direction == 'left' ? jm.direction.left : jm.direction.right;\n            }\n            var node = mind.add_node(parent_node, node_json.id, node_json.topic, data, d, node_json.expanded);\n            node_array.splice(i, 1);\n            extract_count++;\n            var sub_extract_count = df._extract_subnode(mind, node, node_array);\n            if (sub_extract_count > 0) {\n              // reset loop index after extract subordinate node\n              i = node_array.length;\n              extract_count += sub_extract_count;\n            }\n          }\n        }\n        return extract_count;\n      },\n      _extract_data: function (node_json) {\n        var data = {};\n        for (var k in node_json) {\n          if (k == 'id' || k == 'topic' || k == 'parentid' || k == 'isroot' || k == 'direction' || k == 'expanded') {\n            continue;\n          }\n          data[k] = node_json[k];\n        }\n        return data;\n      },\n      _array: function (mind, node_array) {\n        var df = jm.format.node_array;\n        df._array_node(mind.root, node_array);\n      },\n      _array_node: function (node, node_array) {\n        var df = jm.format.node_array;\n        if (!(node instanceof jm.node)) {\n          return;\n        }\n        var o = {\n          id: node.id,\n          topic: node.topic,\n          expanded: node.expanded\n        };\n        if (!!node.parent) {\n          o.parentid = node.parent.id;\n        }\n        if (node.isroot) {\n          o.isroot = true;\n        }\n        if (!!node.parent && node.parent.isroot) {\n          o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n        }\n        if (node.data != null) {\n          var node_data = node.data;\n          for (var k in node_data) {\n            o[k] = node_data[k];\n          }\n        }\n        node_array.push(o);\n        var ci = node.children.length;\n        for (var i = 0; i < ci; i++) {\n          df._array_node(node.children[i], node_array);\n        }\n      }\n    },\n    freemind: {\n      example: {\n        \"meta\": {\n          \"name\": __name__,\n          \"author\": __author__,\n          \"version\": __version__\n        },\n        \"format\": \"freemind\",\n        \"data\": \"<map version=\\\"1.0.1\\\"><node ID=\\\"root\\\" TEXT=\\\"freemind Example\\\"/></map>\"\n      },\n      get_mind: function (source) {\n        var df = jm.format.freemind;\n        var mind = new jm.mind();\n        mind.name = source.meta.name;\n        mind.author = source.meta.author;\n        mind.version = source.meta.version;\n        var xml = source.data;\n        var xml_doc = df._parse_xml(xml);\n        var xml_root = df._find_root(xml_doc);\n        df._load_node(mind, null, xml_root);\n        return mind;\n      },\n      get_data: function (mind) {\n        var df = jm.format.freemind;\n        var json = {};\n        json.meta = {\n          name: mind.name,\n          author: mind.author,\n          version: mind.version\n        };\n        json.format = 'freemind';\n        var xmllines = [];\n        xmllines.push('<map version=\\\"1.0.1\\\">');\n        df._buildmap(mind.root, xmllines);\n        xmllines.push('</map>');\n        json.data = xmllines.join(' ');\n        return json;\n      },\n      _parse_xml: function (xml) {\n        var xml_doc = null;\n        if (window.DOMParser) {\n          var parser = new DOMParser();\n          xml_doc = parser.parseFromString(xml, 'text/xml');\n        } else {\n          // Internet Explorer\n          xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n          xml_doc.async = false;\n          xml_doc.loadXML(xml);\n        }\n        return xml_doc;\n      },\n      _find_root: function (xml_doc) {\n        var nodes = xml_doc.childNodes;\n        var node = null;\n        var root = null;\n        var n = null;\n        for (var i = 0; i < nodes.length; i++) {\n          n = nodes[i];\n          if (n.nodeType == 1 && n.tagName == 'map') {\n            node = n;\n            break;\n          }\n        }\n        if (!!node) {\n          var ns = node.childNodes;\n          node = null;\n          for (var i = 0; i < ns.length; i++) {\n            n = ns[i];\n            if (n.nodeType == 1 && n.tagName == 'node') {\n              node = n;\n              break;\n            }\n          }\n        }\n        return node;\n      },\n      _load_node: function (mind, parent_node, xml_node) {\n        var df = jm.format.freemind;\n        var node_id = xml_node.getAttribute('ID');\n        var node_topic = xml_node.getAttribute('TEXT');\n        // look for richcontent\n        if (node_topic == null) {\n          var topic_children = xml_node.childNodes;\n          var topic_child = null;\n          for (var i = 0; i < topic_children.length; i++) {\n            topic_child = topic_children[i];\n            //logger.debug(topic_child.tagName);\n            if (topic_child.nodeType == 1 && topic_child.tagName === 'richcontent') {\n              node_topic = topic_child.textContent;\n              break;\n            }\n          }\n        }\n        var node_data = df._load_attributes(xml_node);\n        var node_expanded = 'expanded' in node_data ? node_data.expanded == 'true' : true;\n        delete node_data.expanded;\n        var node_position = xml_node.getAttribute('POSITION');\n        var node_direction = null;\n        if (!!node_position) {\n          node_direction = node_position == 'left' ? jm.direction.left : jm.direction.right;\n        }\n        //logger.debug(node_position +':'+ node_direction);\n        var node = null;\n        if (!!parent_node) {\n          node = mind.add_node(parent_node, node_id, node_topic, node_data, node_direction, node_expanded);\n        } else {\n          node = mind.set_root(node_id, node_topic, node_data);\n        }\n        var children = xml_node.childNodes;\n        var child = null;\n        for (var i = 0; i < children.length; i++) {\n          child = children[i];\n          if (child.nodeType == 1 && child.tagName == 'node') {\n            df._load_node(mind, node, child);\n          }\n        }\n      },\n      _load_attributes: function (xml_node) {\n        var children = xml_node.childNodes;\n        var attr = null;\n        var attr_data = {};\n        for (var i = 0; i < children.length; i++) {\n          attr = children[i];\n          if (attr.nodeType == 1 && attr.tagName === 'attribute') {\n            attr_data[attr.getAttribute('NAME')] = attr.getAttribute('VALUE');\n          }\n        }\n        return attr_data;\n      },\n      _buildmap: function (node, xmllines) {\n        var df = jm.format.freemind;\n        var pos = null;\n        if (!!node.parent && node.parent.isroot) {\n          pos = node.direction === jm.direction.left ? 'left' : 'right';\n        }\n        xmllines.push('<node');\n        xmllines.push('ID=\\\"' + node.id + '\\\"');\n        if (!!pos) {\n          xmllines.push('POSITION=\\\"' + pos + '\\\"');\n        }\n        xmllines.push('TEXT=\\\"' + node.topic + '\\\">');\n\n        // store expanded status as an attribute\n        xmllines.push('<attribute NAME=\\\"expanded\\\" VALUE=\\\"' + node.expanded + '\\\"/>');\n\n        // for attributes\n        var node_data = node.data;\n        if (node_data != null) {\n          for (var k in node_data) {\n            xmllines.push('<attribute NAME=\\\"' + k + '\\\" VALUE=\\\"' + node_data[k] + '\\\"/>');\n          }\n        }\n\n        // for children\n        var children = node.children;\n        for (var i = 0; i < children.length; i++) {\n          df._buildmap(children[i], xmllines);\n        }\n        xmllines.push('</node>');\n      }\n    }\n  };\n\n  // ============= utility object =============================================\n\n  jm.util = {\n    is_node: function (node) {\n      return !!node && node instanceof jm.node;\n    },\n    ajax: {\n      request: function (url, param, method, callback, fail_callback) {\n        var a = jm.util.ajax;\n        var p = null;\n        var tmp_param = [];\n        for (var k in param) {\n          tmp_param.push(encodeURIComponent(k) + '=' + encodeURIComponent(param[k]));\n        }\n        if (tmp_param.length > 0) {\n          p = tmp_param.join('&');\n        }\n        var xhr = new XMLHttpRequest();\n        if (!xhr) {\n          return;\n        }\n        xhr.onreadystatechange = function () {\n          if (xhr.readyState == 4) {\n            if (xhr.status == 200 || xhr.status == 0) {\n              if (typeof callback === 'function') {\n                var data = jm.util.json.string2json(xhr.responseText);\n                if (data != null) {\n                  callback(data);\n                } else {\n                  callback(xhr.responseText);\n                }\n              }\n            } else {\n              if (typeof fail_callback === 'function') {\n                fail_callback(xhr);\n              } else {\n                logger.error('xhr request failed.', xhr);\n              }\n            }\n          }\n        };\n        method = method || 'GET';\n        xhr.open(method, url, true);\n        xhr.setRequestHeader('If-Modified-Since', '0');\n        if (method == 'POST') {\n          xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');\n          xhr.send(p);\n        } else {\n          xhr.send();\n        }\n      },\n      get: function (url, callback) {\n        return jm.util.ajax.request(url, {}, 'GET', callback);\n      },\n      post: function (url, param, callback) {\n        return jm.util.ajax.request(url, param, 'POST', callback);\n      }\n    },\n    dom: {\n      //target,eventType,handler\n      add_event: function (t, e, h) {\n        if (!!t.addEventListener) {\n          t.addEventListener(e, h, false);\n        } else {\n          t.attachEvent('on' + e, h);\n        }\n      }\n    },\n    file: {\n      read: function (file_data, fn_callback) {\n        var reader = new FileReader();\n        reader.onload = function () {\n          if (typeof fn_callback === 'function') {\n            fn_callback(this.result, file_data.name);\n          }\n        };\n        reader.readAsText(file_data);\n      },\n      save: function (file_data, type, name) {\n        var blob;\n        if (typeof $w.Blob === 'function') {\n          blob = new Blob([file_data], {\n            type: type\n          });\n        } else {\n          var BlobBuilder = $w.BlobBuilder || $w.MozBlobBuilder || $w.WebKitBlobBuilder || $w.MSBlobBuilder;\n          var bb = new BlobBuilder();\n          bb.append(file_data);\n          blob = bb.getBlob(type);\n        }\n        if (navigator.msSaveBlob) {\n          navigator.msSaveBlob(blob, name);\n        } else {\n          var URL = $w.URL || $w.webkitURL;\n          var bloburl = URL.createObjectURL(blob);\n          var anchor = $c('a');\n          if ('download' in anchor) {\n            anchor.style.visibility = 'hidden';\n            anchor.href = bloburl;\n            anchor.download = name;\n            $d.body.appendChild(anchor);\n            var evt = $d.createEvent('MouseEvents');\n            evt.initEvent('click', true, true);\n            anchor.dispatchEvent(evt);\n            $d.body.removeChild(anchor);\n          } else {\n            location.href = bloburl;\n          }\n        }\n      }\n    },\n    json: {\n      json2string: function (json) {\n        return JSON.stringify(json);\n      },\n      string2json: function (json_str) {\n        return JSON.parse(json_str);\n      },\n      merge: function (b, a) {\n        for (var o in a) {\n          if (o in b) {\n            if (typeof b[o] === 'object' && Object.prototype.toString.call(b[o]).toLowerCase() == '[object object]' && !b[o].length) {\n              jm.util.json.merge(b[o], a[o]);\n            } else {\n              b[o] = a[o];\n            }\n          } else {\n            b[o] = a[o];\n          }\n        }\n        return b;\n      }\n    },\n    uuid: {\n      newid: function () {\n        return (new Date().getTime().toString(16) + Math.random().toString(16).substring(2)).substring(2, 18);\n      }\n    },\n    text: {\n      is_empty: function (s) {\n        if (!s) {\n          return true;\n        }\n        return s.replace(/\\s*/, '').length == 0;\n      }\n    }\n  };\n  jm.prototype = {\n    init: function () {\n      if (this.initialized) {\n        return;\n      }\n      this.initialized = true;\n      var opts = this.options;\n      var opts_layout = {\n        mode: opts.mode,\n        hspace: opts.layout.hspace,\n        vspace: opts.layout.vspace,\n        pspace: opts.layout.pspace,\n        cousin_space: opts.layout.cousin_space\n      };\n      var opts_view = {\n        container: opts.container,\n        support_html: opts.support_html,\n        engine: opts.view.engine,\n        hmargin: opts.view.hmargin,\n        vmargin: opts.view.vmargin,\n        line_width: opts.view.line_width,\n        line_color: opts.view.line_color,\n        draggable: opts.view.draggable,\n        hide_scrollbars_when_draggable: opts.view.hide_scrollbars_when_draggable,\n        node_overflow: opts.view.node_overflow\n      };\n      // create instance of function provider\n      this.data = new jm.data_provider(this);\n      this.layout = new jm.layout_provider(this, opts_layout);\n      this.view = new jm.view_provider(this, opts_view);\n      this.shortcut = new jm.shortcut_provider(this, opts.shortcut);\n      this.data.init();\n      this.layout.init();\n      this.view.init();\n      this.shortcut.init();\n      this._event_bind();\n      jm.init_plugins(this);\n    },\n    enable_edit: function () {\n      this.options.editable = true;\n    },\n    disable_edit: function () {\n      this.options.editable = false;\n    },\n    // call enable_event_handle('dblclick')\n    // options are 'mousedown', 'click', 'dblclick'\n    enable_event_handle: function (event_handle) {\n      this.options.default_event_handle['enable_' + event_handle + '_handle'] = true;\n    },\n    // call disable_event_handle('dblclick')\n    // options are 'mousedown', 'click', 'dblclick'\n    disable_event_handle: function (event_handle) {\n      this.options.default_event_handle['enable_' + event_handle + '_handle'] = false;\n    },\n    get_editable: function () {\n      return this.options.editable;\n    },\n    set_theme: function (theme) {\n      var theme_old = this.options.theme;\n      this.options.theme = !!theme ? theme : null;\n      if (theme_old != this.options.theme) {\n        this.view.reset_theme();\n        this.view.reset_custom_style();\n      }\n    },\n    _event_bind: function () {\n      this.view.add_event(this, 'mousedown', this.mousedown_handle);\n      this.view.add_event(this, 'click', this.click_handle);\n      this.view.add_event(this, 'dblclick', this.dblclick_handle);\n      this.view.add_event(this, \"mousewheel\", this.mousewheel_handle);\n    },\n    mousedown_handle: function (e) {\n      if (!this.options.default_event_handle['enable_mousedown_handle']) {\n        return;\n      }\n      var element = e.target || event.srcElement;\n      var nodeid = this.view.get_binded_nodeid(element);\n      if (!!nodeid) {\n        if (this.view.is_node(element)) {\n          this.select_node(nodeid);\n        }\n      } else {\n        this.select_clear();\n      }\n    },\n    click_handle: function (e) {\n      if (!this.options.default_event_handle['enable_click_handle']) {\n        return;\n      }\n      var element = e.target || event.srcElement;\n      var is_expander = this.view.is_expander(element);\n      if (is_expander) {\n        var nodeid = this.view.get_binded_nodeid(element);\n        if (!!nodeid) {\n          this.toggle_node(nodeid);\n        }\n      }\n    },\n    dblclick_handle: function (e) {\n      if (!this.options.default_event_handle['enable_dblclick_handle']) {\n        return;\n      }\n      if (this.get_editable()) {\n        var element = e.target || event.srcElement;\n        var is_node = this.view.is_node(element);\n        if (is_node) {\n          var nodeid = this.view.get_binded_nodeid(element);\n          if (!!nodeid) {\n            this.begin_edit(nodeid);\n          }\n        }\n      }\n    },\n    // Use [Ctrl] + Mousewheel, to zoom in/out.\n    mousewheel_handle: function (event) {\n      // Test if mousewheel option is enabled and Ctrl key is pressed.\n      if (!this.options.default_event_handle[\"enable_mousewheel_handle\"] || !window.event.ctrlKey) {\n        return;\n      }\n      // Avoid default page scrolling behavior.\n      event.preventDefault();\n      if (event.deltaY < 0) {\n        this.view.zoomIn();\n      } else {\n        this.view.zoomOut();\n      }\n    },\n    begin_edit: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return false;\n        } else {\n          return this.begin_edit(the_node);\n        }\n      }\n      if (this.get_editable()) {\n        this.view.edit_node_begin(node);\n      } else {\n        logger.error('fail, this mind map is not editable.');\n        return;\n      }\n    },\n    end_edit: function () {\n      this.view.edit_node_end();\n    },\n    toggle_node: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return;\n        } else {\n          return this.toggle_node(the_node);\n        }\n      }\n      if (node.isroot) {\n        return;\n      }\n      this.view.save_location(node);\n      this.layout.toggle_node(node);\n      this.view.relayout();\n      this.view.restore_location(node);\n    },\n    expand_node: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return;\n        } else {\n          return this.expand_node(the_node);\n        }\n      }\n      if (node.isroot) {\n        return;\n      }\n      this.view.save_location(node);\n      this.layout.expand_node(node);\n      this.view.relayout();\n      this.view.restore_location(node);\n    },\n    collapse_node: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return;\n        } else {\n          return this.collapse_node(the_node);\n        }\n      }\n      if (node.isroot) {\n        return;\n      }\n      this.view.save_location(node);\n      this.layout.collapse_node(node);\n      this.view.relayout();\n      this.view.restore_location(node);\n    },\n    expand_all: function () {\n      this.layout.expand_all();\n      this.view.relayout();\n    },\n    collapse_all: function () {\n      this.layout.collapse_all();\n      this.view.relayout();\n    },\n    expand_to_depth: function (depth) {\n      this.layout.expand_to_depth(depth);\n      this.view.relayout();\n    },\n    _reset: function () {\n      this.view.reset();\n      this.layout.reset();\n      this.data.reset();\n    },\n    _show: function (mind) {\n      var m = mind || jm.format.node_array.example;\n      this.mind = this.data.load(m);\n      if (!this.mind) {\n        logger.error('data.load error');\n        return;\n      } else {\n        logger.debug('data.load ok');\n      }\n      this.view.load();\n      logger.debug('view.load ok');\n      this.layout.layout();\n      logger.debug('layout.layout ok');\n      this.view.show(true);\n      logger.debug('view.show ok');\n      this.invoke_event_handle(jm.event_type.show, {\n        data: [mind]\n      });\n    },\n    show: function (mind) {\n      this._reset();\n      this._show(mind);\n    },\n    get_meta: function () {\n      return {\n        name: this.mind.name,\n        author: this.mind.author,\n        version: this.mind.version\n      };\n    },\n    get_data: function (data_format) {\n      var df = data_format || 'node_tree';\n      return this.data.get_data(df);\n    },\n    get_root: function () {\n      return this.mind.root;\n    },\n    get_node: function (node) {\n      if (jm.util.is_node(node)) {\n        return node;\n      }\n      return this.mind.get_node(node);\n    },\n    add_node: function (parent_node, nodeid, topic, data, direction) {\n      if (this.get_editable()) {\n        var the_parent_node = this.get_node(parent_node);\n        var dir = jm.direction.of(direction);\n        if (dir === undefined) {\n          dir = this.layout.calculate_next_child_direction(the_parent_node);\n        }\n        var node = this.mind.add_node(the_parent_node, nodeid, topic, data, dir);\n        if (!!node) {\n          this.view.add_node(node);\n          this.layout.layout();\n          this.view.show(false);\n          this.view.reset_node_custom_style(node);\n          this.expand_node(the_parent_node);\n          this.invoke_event_handle(jm.event_type.edit, {\n            evt: 'add_node',\n            data: [the_parent_node.id, nodeid, topic, data, dir],\n            node: nodeid\n          });\n        }\n        return node;\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return null;\n      }\n    },\n    insert_node_before: function (node_before, nodeid, topic, data, direction) {\n      if (this.get_editable()) {\n        var the_node_before = this.get_node(node_before);\n        var dir = jm.direction.of(direction);\n        if (dir === undefined) {\n          dir = this.layout.calculate_next_child_direction(the_node_before.parent);\n        }\n        var node = this.mind.insert_node_before(the_node_before, nodeid, topic, data, dir);\n        if (!!node) {\n          this.view.add_node(node);\n          this.layout.layout();\n          this.view.show(false);\n          this.invoke_event_handle(jm.event_type.edit, {\n            evt: 'insert_node_before',\n            data: [the_node_before.id, nodeid, topic, data, dir],\n            node: nodeid\n          });\n        }\n        return node;\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return null;\n      }\n    },\n    insert_node_after: function (node_after, nodeid, topic, data, direction) {\n      if (this.get_editable()) {\n        var the_node_after = this.get_node(node_after);\n        var dir = jm.direction.of(direction);\n        if (dir === undefined) {\n          dir = this.layout.calculate_next_child_direction(the_node_after.parent);\n        }\n        var node = this.mind.insert_node_after(the_node_after, nodeid, topic, data, dir);\n        if (!!node) {\n          this.view.add_node(node);\n          this.layout.layout();\n          this.view.show(false);\n          this.invoke_event_handle(jm.event_type.edit, {\n            evt: 'insert_node_after',\n            data: [the_node_after.id, nodeid, topic, data, dir],\n            node: nodeid\n          });\n        }\n        return node;\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return null;\n      }\n    },\n    remove_node: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return false;\n        } else {\n          return this.remove_node(the_node);\n        }\n      }\n      if (this.get_editable()) {\n        if (node.isroot) {\n          logger.error('fail, can not remove root node');\n          return false;\n        }\n        var nodeid = node.id;\n        var parentid = node.parent.id;\n        var parent_node = this.get_node(parentid);\n        this.view.save_location(parent_node);\n        this.view.remove_node(node);\n        this.mind.remove_node(node);\n        this.layout.layout();\n        this.view.show(false);\n        this.view.restore_location(parent_node);\n        this.invoke_event_handle(jm.event_type.edit, {\n          evt: 'remove_node',\n          data: [nodeid],\n          node: parentid\n        });\n        return true;\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return false;\n      }\n    },\n    update_node: function (nodeid, topic) {\n      if (this.get_editable()) {\n        if (jm.util.text.is_empty(topic)) {\n          logger.warn('fail, topic can not be empty');\n          return;\n        }\n        var node = this.get_node(nodeid);\n        if (!!node) {\n          if (node.topic === topic) {\n            logger.info('nothing changed');\n            this.view.update_node(node);\n            return;\n          }\n          node.topic = topic;\n          this.view.update_node(node);\n          this.layout.layout();\n          this.view.show(false);\n          this.invoke_event_handle(jm.event_type.edit, {\n            evt: 'update_node',\n            data: [nodeid, topic],\n            node: nodeid\n          });\n        }\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return;\n      }\n    },\n    move_node: function (nodeid, beforeid, parentid, direction) {\n      if (this.get_editable()) {\n        var node = this.get_node(nodeid);\n        var updated_node = this.mind.move_node(node, beforeid, parentid, direction);\n        if (!!updated_node) {\n          this.view.update_node(updated_node);\n          this.layout.layout();\n          this.view.show(false);\n          this.invoke_event_handle(jm.event_type.edit, {\n            evt: 'move_node',\n            data: [nodeid, beforeid, parentid, direction],\n            node: nodeid\n          });\n        }\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return;\n      }\n    },\n    select_node: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return;\n        } else {\n          return this.select_node(the_node);\n        }\n      }\n      if (!this.layout.is_visible(node)) {\n        return;\n      }\n      this.mind.selected = node;\n      this.view.select_node(node);\n      this.invoke_event_handle(jm.event_type.select, {\n        evt: 'select_node',\n        data: [],\n        node: node.id\n      });\n    },\n    get_selected_node: function () {\n      if (!!this.mind) {\n        return this.mind.selected;\n      } else {\n        return null;\n      }\n    },\n    select_clear: function () {\n      if (!!this.mind) {\n        this.mind.selected = null;\n        this.view.select_clear();\n      }\n    },\n    is_node_visible: function (node) {\n      return this.layout.is_visible(node);\n    },\n    find_node_before: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return;\n        } else {\n          return this.find_node_before(the_node);\n        }\n      }\n      if (node.isroot) {\n        return null;\n      }\n      var n = null;\n      if (node.parent.isroot) {\n        var c = node.parent.children;\n        var prev = null;\n        var ni = null;\n        for (var i = 0; i < c.length; i++) {\n          ni = c[i];\n          if (node.direction === ni.direction) {\n            if (node.id === ni.id) {\n              n = prev;\n            }\n            prev = ni;\n          }\n        }\n      } else {\n        n = this.mind.get_node_before(node);\n      }\n      return n;\n    },\n    find_node_after: function (node) {\n      if (!jm.util.is_node(node)) {\n        var the_node = this.get_node(node);\n        if (!the_node) {\n          logger.error('the node[id=' + node + '] can not be found.');\n          return;\n        } else {\n          return this.find_node_after(the_node);\n        }\n      }\n      if (node.isroot) {\n        return null;\n      }\n      var n = null;\n      if (node.parent.isroot) {\n        var c = node.parent.children;\n        var getthis = false;\n        var ni = null;\n        for (var i = 0; i < c.length; i++) {\n          ni = c[i];\n          if (node.direction === ni.direction) {\n            if (getthis) {\n              n = ni;\n              break;\n            }\n            if (node.id === ni.id) {\n              getthis = true;\n            }\n          }\n        }\n      } else {\n        n = this.mind.get_node_after(node);\n      }\n      return n;\n    },\n    set_node_color: function (nodeid, bgcolor, fgcolor) {\n      if (this.get_editable()) {\n        var node = this.mind.get_node(nodeid);\n        if (!!node) {\n          if (!!bgcolor) {\n            node.data['background-color'] = bgcolor;\n          }\n          if (!!fgcolor) {\n            node.data['foreground-color'] = fgcolor;\n          }\n          this.view.reset_node_custom_style(node);\n        }\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return null;\n      }\n    },\n    set_node_font_style: function (nodeid, size, weight, style) {\n      if (this.get_editable()) {\n        var node = this.mind.get_node(nodeid);\n        if (!!node) {\n          if (!!size) {\n            node.data['font-size'] = size;\n          }\n          if (!!weight) {\n            node.data['font-weight'] = weight;\n          }\n          if (!!style) {\n            node.data['font-style'] = style;\n          }\n          this.view.reset_node_custom_style(node);\n          this.view.update_node(node);\n          this.layout.layout();\n          this.view.show(false);\n        }\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return null;\n      }\n    },\n    set_node_background_image: function (nodeid, image, width, height, rotation) {\n      if (this.get_editable()) {\n        var node = this.mind.get_node(nodeid);\n        if (!!node) {\n          if (!!image) {\n            node.data['background-image'] = image;\n          }\n          if (!!width) {\n            node.data['width'] = width;\n          }\n          if (!!height) {\n            node.data['height'] = height;\n          }\n          if (!!rotation) {\n            node.data['background-rotation'] = rotation;\n          }\n          this.view.reset_node_custom_style(node);\n          this.view.update_node(node);\n          this.layout.layout();\n          this.view.show(false);\n        }\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return null;\n      }\n    },\n    set_node_background_rotation: function (nodeid, rotation) {\n      if (this.get_editable()) {\n        var node = this.mind.get_node(nodeid);\n        if (!!node) {\n          if (!node.data['background-image']) {\n            logger.error('fail, only can change rotation angle of node with background image');\n            return null;\n          }\n          node.data['background-rotation'] = rotation;\n          this.view.reset_node_custom_style(node);\n          this.view.update_node(node);\n          this.layout.layout();\n          this.view.show(false);\n        }\n      } else {\n        logger.error('fail, this mind map is not editable');\n        return null;\n      }\n    },\n    resize: function () {\n      this.view.resize();\n    },\n    // callback(type ,data)\n    add_event_listener: function (callback) {\n      if (typeof callback === 'function') {\n        this.event_handles.push(callback);\n      }\n    },\n    clear_event_listener: function () {\n      this.event_handles = [];\n    },\n    invoke_event_handle: function (type, data) {\n      var j = this;\n      $w.setTimeout(function () {\n        j._invoke_event_handle(type, data);\n      }, 0);\n    },\n    _invoke_event_handle: function (type, data) {\n      var l = this.event_handles.length;\n      for (var i = 0; i < l; i++) {\n        this.event_handles[i](type, data);\n      }\n    }\n  };\n\n  // ============= data provider =============================================\n\n  jm.data_provider = function (jm) {\n    this.jm = jm;\n  };\n  jm.data_provider.prototype = {\n    init: function () {\n      logger.debug('data.init');\n    },\n    reset: function () {\n      logger.debug('data.reset');\n    },\n    load: function (mind_data) {\n      var df = null;\n      var mind = null;\n      if (typeof mind_data === 'object') {\n        if (!!mind_data.format) {\n          df = mind_data.format;\n        } else {\n          df = 'node_tree';\n        }\n      } else {\n        df = 'freemind';\n      }\n      if (df == 'node_array') {\n        mind = jm.format.node_array.get_mind(mind_data);\n      } else if (df == 'node_tree') {\n        mind = jm.format.node_tree.get_mind(mind_data);\n      } else if (df == 'freemind') {\n        mind = jm.format.freemind.get_mind(mind_data);\n      } else {\n        logger.warn('unsupported format');\n      }\n      return mind;\n    },\n    get_data: function (data_format) {\n      var data = null;\n      if (data_format == 'node_array') {\n        data = jm.format.node_array.get_data(this.jm.mind);\n      } else if (data_format == 'node_tree') {\n        data = jm.format.node_tree.get_data(this.jm.mind);\n      } else if (data_format == 'freemind') {\n        data = jm.format.freemind.get_data(this.jm.mind);\n      } else {\n        logger.error('unsupported ' + data_format + ' format');\n      }\n      return data;\n    }\n  };\n\n  // ============= layout provider ===========================================\n\n  jm.layout_provider = function (jm, options) {\n    this.opts = options;\n    this.jm = jm;\n    this.isside = this.opts.mode == 'side';\n    this.bounds = null;\n    this.cache_valid = false;\n  };\n  jm.layout_provider.prototype = {\n    init: function () {\n      logger.debug('layout.init');\n    },\n    reset: function () {\n      logger.debug('layout.reset');\n      this.bounds = {\n        n: 0,\n        s: 0,\n        w: 0,\n        e: 0\n      };\n    },\n    calculate_next_child_direction: function (node) {\n      if (this.isside) {\n        return jm.direction.right;\n      }\n      var children = node.children || [];\n      var children_len = children.length;\n      var r = 0;\n      for (var i = 0; i < children_len; i++) {\n        if (children[i].direction === jm.direction.left) {\n          r--;\n        } else {\n          r++;\n        }\n      }\n      return children_len > 1 && r > 0 ? jm.direction.left : jm.direction.right;\n    },\n    layout: function () {\n      logger.debug('layout.layout');\n      this.layout_direction();\n      this.layout_offset();\n    },\n    layout_direction: function () {\n      this._layout_direction_root();\n    },\n    _layout_direction_root: function () {\n      var node = this.jm.mind.root;\n      // logger.debug(node);\n      var layout_data = null;\n      if ('layout' in node._data) {\n        layout_data = node._data.layout;\n      } else {\n        layout_data = {};\n        node._data.layout = layout_data;\n      }\n      var children = node.children;\n      var children_count = children.length;\n      layout_data.direction = jm.direction.center;\n      layout_data.side_index = 0;\n      if (this.isside) {\n        var i = children_count;\n        while (i--) {\n          this._layout_direction_side(children[i], jm.direction.right, i);\n        }\n      } else {\n        var i = children_count;\n        var subnode = null;\n        while (i--) {\n          subnode = children[i];\n          if (subnode.direction == jm.direction.left) {\n            this._layout_direction_side(subnode, jm.direction.left, i);\n          } else {\n            this._layout_direction_side(subnode, jm.direction.right, i);\n          }\n        }\n        /*\n        var boundary = Math.ceil(children_count/2);\n        var i = children_count;\n        while(i--){\n            if(i>=boundary){\n                this._layout_direction_side(children[i],jm.direction.left, children_count-i-1);\n            }else{\n                this._layout_direction_side(children[i],jm.direction.right, i);\n            }\n        }*/\n      }\n    },\n\n    _layout_direction_side: function (node, direction, side_index) {\n      var layout_data = null;\n      if ('layout' in node._data) {\n        layout_data = node._data.layout;\n      } else {\n        layout_data = {};\n        node._data.layout = layout_data;\n      }\n      var children = node.children;\n      var children_count = children.length;\n      layout_data.direction = direction;\n      layout_data.side_index = side_index;\n      var i = children_count;\n      while (i--) {\n        this._layout_direction_side(children[i], direction, i);\n      }\n    },\n    layout_offset: function () {\n      var node = this.jm.mind.root;\n      var layout_data = node._data.layout;\n      layout_data.offset_x = 0;\n      layout_data.offset_y = 0;\n      layout_data.outer_height = 0;\n      var children = node.children;\n      var i = children.length;\n      var left_nodes = [];\n      var right_nodes = [];\n      var subnode = null;\n      while (i--) {\n        subnode = children[i];\n        if (subnode._data.layout.direction == jm.direction.right) {\n          right_nodes.unshift(subnode);\n        } else {\n          left_nodes.unshift(subnode);\n        }\n      }\n      layout_data.left_nodes = left_nodes;\n      layout_data.right_nodes = right_nodes;\n      layout_data.outer_height_left = this._layout_offset_subnodes(left_nodes);\n      layout_data.outer_height_right = this._layout_offset_subnodes(right_nodes);\n      this.bounds.e = node._data.view.width / 2;\n      this.bounds.w = 0 - this.bounds.e;\n      //logger.debug(this.bounds.w);\n      this.bounds.n = 0;\n      this.bounds.s = Math.max(layout_data.outer_height_left, layout_data.outer_height_right);\n    },\n    // layout both the x and y axis\n    _layout_offset_subnodes: function (nodes) {\n      var total_height = 0;\n      var nodes_count = nodes.length;\n      var i = nodes_count;\n      var node = null;\n      var node_outer_height = 0;\n      var layout_data = null;\n      var base_y = 0;\n      var pd = null; // parent._data\n      while (i--) {\n        node = nodes[i];\n        layout_data = node._data.layout;\n        if (pd == null) {\n          pd = node.parent._data;\n        }\n        node_outer_height = this._layout_offset_subnodes(node.children);\n        if (!node.expanded) {\n          node_outer_height = 0;\n          this.set_visible(node.children, false);\n        }\n        node_outer_height = Math.max(node._data.view.height, node_outer_height);\n        if (node.children.length > 1) {\n          node_outer_height += this.opts.cousin_space;\n        }\n        layout_data.outer_height = node_outer_height;\n        layout_data.offset_y = base_y - node_outer_height / 2;\n        layout_data.offset_x = this.opts.hspace * layout_data.direction + pd.view.width * (pd.layout.direction + layout_data.direction) / 2;\n        if (!node.parent.isroot) {\n          layout_data.offset_x += this.opts.pspace * layout_data.direction;\n        }\n        base_y = base_y - node_outer_height - this.opts.vspace;\n        total_height += node_outer_height;\n      }\n      if (nodes_count > 1) {\n        total_height += this.opts.vspace * (nodes_count - 1);\n      }\n      i = nodes_count;\n      var middle_height = total_height / 2;\n      while (i--) {\n        node = nodes[i];\n        node._data.layout.offset_y += middle_height;\n      }\n      return total_height;\n    },\n    // layout the y axis only, for collapse/expand a node\n    _layout_offset_subnodes_height: function (nodes) {\n      var total_height = 0;\n      var nodes_count = nodes.length;\n      var i = nodes_count;\n      var node = null;\n      var node_outer_height = 0;\n      var layout_data = null;\n      var base_y = 0;\n      var pd = null; // parent._data\n      while (i--) {\n        node = nodes[i];\n        layout_data = node._data.layout;\n        if (pd == null) {\n          pd = node.parent._data;\n        }\n        node_outer_height = this._layout_offset_subnodes_height(node.children);\n        if (!node.expanded) {\n          node_outer_height = 0;\n        }\n        node_outer_height = Math.max(node._data.view.height, node_outer_height);\n        if (node.children.length > 1) {\n          node_outer_height += this.opts.cousin_space;\n        }\n        layout_data.outer_height = node_outer_height;\n        layout_data.offset_y = base_y - node_outer_height / 2;\n        base_y = base_y - node_outer_height - this.opts.vspace;\n        total_height += node_outer_height;\n      }\n      if (nodes_count > 1) {\n        total_height += this.opts.vspace * (nodes_count - 1);\n      }\n      i = nodes_count;\n      var middle_height = total_height / 2;\n      while (i--) {\n        node = nodes[i];\n        node._data.layout.offset_y += middle_height;\n        //logger.debug(node.topic);\n        //logger.debug(node._data.layout.offset_y);\n      }\n\n      return total_height;\n    },\n    get_node_offset: function (node) {\n      var layout_data = node._data.layout;\n      var offset_cache = null;\n      if ('_offset_' in layout_data && this.cache_valid) {\n        offset_cache = layout_data._offset_;\n      } else {\n        offset_cache = {\n          x: -1,\n          y: -1\n        };\n        layout_data._offset_ = offset_cache;\n      }\n      if (offset_cache.x == -1 || offset_cache.y == -1) {\n        var x = layout_data.offset_x;\n        var y = layout_data.offset_y;\n        if (!node.isroot) {\n          var offset_p = this.get_node_offset(node.parent);\n          x += offset_p.x;\n          y += offset_p.y;\n        }\n        offset_cache.x = x;\n        offset_cache.y = y;\n      }\n      return offset_cache;\n    },\n    get_node_point: function (node) {\n      var view_data = node._data.view;\n      var offset_p = this.get_node_offset(node);\n      //logger.debug(offset_p);\n      var p = {};\n      p.x = offset_p.x + view_data.width * (node._data.layout.direction - 1) / 2;\n      p.y = offset_p.y - view_data.height / 2;\n      //logger.debug(p);\n      return p;\n    },\n    get_node_point_in: function (node) {\n      var p = this.get_node_offset(node);\n      return p;\n    },\n    get_node_point_out: function (node) {\n      var layout_data = node._data.layout;\n      var pout_cache = null;\n      if ('_pout_' in layout_data && this.cache_valid) {\n        pout_cache = layout_data._pout_;\n      } else {\n        pout_cache = {\n          x: -1,\n          y: -1\n        };\n        layout_data._pout_ = pout_cache;\n      }\n      if (pout_cache.x == -1 || pout_cache.y == -1) {\n        if (node.isroot) {\n          pout_cache.x = 0;\n          pout_cache.y = 0;\n        } else {\n          var view_data = node._data.view;\n          var offset_p = this.get_node_offset(node);\n          pout_cache.x = offset_p.x + (view_data.width + this.opts.pspace) * node._data.layout.direction;\n          pout_cache.y = offset_p.y;\n          //logger.debug('pout');\n          //logger.debug(pout_cache);\n        }\n      }\n\n      return pout_cache;\n    },\n    get_expander_point: function (node) {\n      var p = this.get_node_point_out(node);\n      var ex_p = {};\n      if (node._data.layout.direction == jm.direction.right) {\n        ex_p.x = p.x - this.opts.pspace;\n      } else {\n        ex_p.x = p.x;\n      }\n      ex_p.y = p.y - Math.ceil(this.opts.pspace / 2);\n      return ex_p;\n    },\n    get_min_size: function () {\n      var nodes = this.jm.mind.nodes;\n      var node = null;\n      var pout = null;\n      for (var nodeid in nodes) {\n        node = nodes[nodeid];\n        pout = this.get_node_point_out(node);\n        if (pout.x > this.bounds.e) {\n          this.bounds.e = pout.x;\n        }\n        if (pout.x < this.bounds.w) {\n          this.bounds.w = pout.x;\n        }\n      }\n      return {\n        w: this.bounds.e - this.bounds.w,\n        h: this.bounds.s - this.bounds.n\n      };\n    },\n    toggle_node: function (node) {\n      if (node.isroot) {\n        return;\n      }\n      if (node.expanded) {\n        this.collapse_node(node);\n      } else {\n        this.expand_node(node);\n      }\n    },\n    expand_node: function (node) {\n      node.expanded = true;\n      this.part_layout(node);\n      this.set_visible(node.children, true);\n      this.jm.invoke_event_handle(jm.event_type.show, {\n        evt: 'expand_node',\n        data: [],\n        node: node.id\n      });\n    },\n    collapse_node: function (node) {\n      node.expanded = false;\n      this.part_layout(node);\n      this.set_visible(node.children, false);\n      this.jm.invoke_event_handle(jm.event_type.show, {\n        evt: 'collapse_node',\n        data: [],\n        node: node.id\n      });\n    },\n    expand_all: function () {\n      var nodes = this.jm.mind.nodes;\n      var c = 0;\n      var node;\n      for (var nodeid in nodes) {\n        node = nodes[nodeid];\n        if (!node.expanded) {\n          node.expanded = true;\n          c++;\n        }\n      }\n      if (c > 0) {\n        var root = this.jm.mind.root;\n        this.part_layout(root);\n        this.set_visible(root.children, true);\n      }\n    },\n    collapse_all: function () {\n      var nodes = this.jm.mind.nodes;\n      var c = 0;\n      var node;\n      for (var nodeid in nodes) {\n        node = nodes[nodeid];\n        if (node.expanded && !node.isroot) {\n          node.expanded = false;\n          c++;\n        }\n      }\n      if (c > 0) {\n        var root = this.jm.mind.root;\n        this.part_layout(root);\n        this.set_visible(root.children, true);\n      }\n    },\n    expand_to_depth: function (target_depth, curr_nodes, curr_depth) {\n      if (target_depth < 1) {\n        return;\n      }\n      var nodes = curr_nodes || this.jm.mind.root.children;\n      var depth = curr_depth || 1;\n      var i = nodes.length;\n      var node = null;\n      while (i--) {\n        node = nodes[i];\n        if (depth < target_depth) {\n          if (!node.expanded) {\n            this.expand_node(node);\n          }\n          this.expand_to_depth(target_depth, node.children, depth + 1);\n        }\n        if (depth == target_depth) {\n          if (node.expanded) {\n            this.collapse_node(node);\n          }\n        }\n      }\n    },\n    part_layout: function (node) {\n      var root = this.jm.mind.root;\n      if (!!root) {\n        var root_layout_data = root._data.layout;\n        if (node.isroot) {\n          root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n          root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n        } else {\n          if (node._data.layout.direction == jm.direction.right) {\n            root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n          } else {\n            root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n          }\n        }\n        this.bounds.s = Math.max(root_layout_data.outer_height_left, root_layout_data.outer_height_right);\n        this.cache_valid = false;\n      } else {\n        logger.warn('can not found root node');\n      }\n    },\n    set_visible: function (nodes, visible) {\n      var i = nodes.length;\n      var node = null;\n      var layout_data = null;\n      while (i--) {\n        node = nodes[i];\n        layout_data = node._data.layout;\n        if (node.expanded) {\n          this.set_visible(node.children, visible);\n        } else {\n          this.set_visible(node.children, false);\n        }\n        if (!node.isroot) {\n          node._data.layout.visible = visible;\n        }\n      }\n    },\n    is_expand: function (node) {\n      return node.expanded;\n    },\n    is_visible: function (node) {\n      var layout_data = node._data.layout;\n      if ('visible' in layout_data && !layout_data.visible) {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  };\n  jm.graph_canvas = function (view) {\n    this.opts = view.opts;\n    this.e_canvas = $c('canvas');\n    this.e_canvas.className = 'jsmind';\n    this.canvas_ctx = this.e_canvas.getContext('2d');\n    this.size = {\n      w: 0,\n      h: 0\n    };\n  };\n  jm.graph_canvas.prototype = {\n    element: function () {\n      return this.e_canvas;\n    },\n    set_size: function (w, h) {\n      this.size.w = w;\n      this.size.h = h;\n      this.e_canvas.width = w;\n      this.e_canvas.height = h;\n    },\n    clear: function () {\n      this.canvas_ctx.clearRect(0, 0, this.size.w, this.size.h);\n    },\n    draw_line: function (pout, pin, offset) {\n      var ctx = this.canvas_ctx;\n      ctx.strokeStyle = this.opts.line_color;\n      ctx.lineWidth = this.opts.line_width;\n      ctx.lineCap = 'round';\n      this._bezier_to(ctx, pin.x + offset.x, pin.y + offset.y, pout.x + offset.x, pout.y + offset.y);\n    },\n    copy_to: function (dest_canvas_ctx, callback) {\n      dest_canvas_ctx.drawImage(this.e_canvas, 0, 0);\n      !!callback && callback();\n    },\n    _bezier_to: function (ctx, x1, y1, x2, y2) {\n      ctx.beginPath();\n      ctx.moveTo(x1, y1);\n      ctx.bezierCurveTo(x1 + (x2 - x1) * 2 / 3, y1, x1, y2, x2, y2);\n      ctx.stroke();\n    },\n    _line_to: function (ctx, x1, y1, x2, y2) {\n      ctx.beginPath();\n      ctx.moveTo(x1, y1);\n      ctx.lineTo(x2, y2);\n      ctx.stroke();\n    }\n  };\n  jm.graph_svg = function (view) {\n    this.view = view;\n    this.opts = view.opts;\n    this.e_svg = jm.graph_svg.c('svg');\n    this.e_svg.setAttribute('class', 'jsmind');\n    this.size = {\n      w: 0,\n      h: 0\n    };\n    this.lines = [];\n  };\n  jm.graph_svg.c = function (tag) {\n    return $d.createElementNS('http://www.w3.org/2000/svg', tag);\n  };\n  jm.graph_svg.prototype = {\n    element: function () {\n      return this.e_svg;\n    },\n    set_size: function (w, h) {\n      this.size.w = w;\n      this.size.h = h;\n      this.e_svg.setAttribute('width', w);\n      this.e_svg.setAttribute('height', h);\n    },\n    clear: function () {\n      var len = this.lines.length;\n      while (len--) {\n        this.e_svg.removeChild(this.lines[len]);\n      }\n      this.lines.length = 0;\n    },\n    draw_line: function (pout, pin, offset) {\n      var line = jm.graph_svg.c('path');\n      line.setAttribute('stroke', this.opts.line_color);\n      line.setAttribute('stroke-width', this.opts.line_width);\n      line.setAttribute('fill', 'transparent');\n      this.lines.push(line);\n      this.e_svg.appendChild(line);\n      this._bezier_to(line, pin.x + offset.x, pin.y + offset.y, pout.x + offset.x, pout.y + offset.y);\n    },\n    copy_to: function (dest_canvas_ctx, callback) {\n      var img = new Image();\n      img.onload = function () {\n        dest_canvas_ctx.drawImage(img, 0, 0);\n        !!callback && callback();\n      };\n      img.src = 'data:image/svg+xml;base64,' + btoa(new XMLSerializer().serializeToString(this.e_svg));\n    },\n    _bezier_to: function (path, x1, y1, x2, y2) {\n      path.setAttribute('d', 'M' + x1 + ' ' + y1 + ' C ' + (x1 + (x2 - x1) * 2 / 3) + ' ' + y1 + ', ' + x1 + ' ' + y2 + ', ' + x2 + ' ' + y2);\n    },\n    _line_to: function (path, x1, y1, x2, y2) {\n      path.setAttribute('d', 'M ' + x1 + ' ' + y1 + ' L ' + x2 + ' ' + y2);\n    }\n  };\n\n  // view provider\n  jm.view_provider = function (jm, options) {\n    this.opts = options;\n    this.jm = jm;\n    this.layout = jm.layout;\n    this.container = null;\n    this.e_panel = null;\n    this.e_nodes = null;\n    this.size = {\n      w: 0,\n      h: 0\n    };\n    this.selected_node = null;\n    this.editing_node = null;\n    this.graph = null;\n  };\n  jm.view_provider.prototype = {\n    init: function () {\n      logger.debug('view.init');\n      this.container = $i(this.opts.container) ? this.opts.container : $g(this.opts.container);\n      if (!this.container) {\n        logger.error('the options.view.container was not be found in dom');\n        return;\n      }\n      this.e_panel = $c('div');\n      this.e_nodes = $c('jmnodes');\n      this.e_editor = $c('input');\n      this.graph = this.opts.engine.toLowerCase() === 'svg' ? new jm.graph_svg(this) : new jm.graph_canvas(this);\n      this.e_panel.className = 'jsmind-inner jmnode-overflow-' + this.opts.node_overflow;\n      this.e_panel.tabIndex = 1;\n      this.e_panel.appendChild(this.graph.element());\n      this.e_panel.appendChild(this.e_nodes);\n      this.e_editor.className = 'jsmind-editor';\n      this.e_editor.type = 'text';\n      this.actualZoom = 1;\n      this.zoomStep = 0.1;\n      this.minZoom = 0.5;\n      this.maxZoom = 2;\n      var v = this;\n      jm.util.dom.add_event(this.e_editor, 'keydown', function (e) {\n        var evt = e || event;\n        if (evt.keyCode == 13) {\n          v.edit_node_end();\n          evt.stopPropagation();\n        }\n      });\n      jm.util.dom.add_event(this.e_editor, 'blur', function (e) {\n        v.edit_node_end();\n      });\n      this.container.appendChild(this.e_panel);\n\n      // Used to avoid dragging, while editing node.\n      this.dragging_enabled = true;\n      this.draggable_canvas();\n    },\n    add_event: function (obj, event_name, event_handle) {\n      jm.util.dom.add_event(this.e_nodes, event_name, function (e) {\n        var evt = e || event;\n        event_handle.call(obj, evt);\n      });\n    },\n    get_binded_nodeid: function (element) {\n      if (element == null) {\n        return null;\n      }\n      var tagName = element.tagName.toLowerCase();\n      if (tagName == 'jmnode' || tagName == 'jmexpander') {\n        return element.getAttribute('nodeid');\n      } else if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n        return null;\n      } else {\n        return this.get_binded_nodeid(element.parentElement);\n      }\n    },\n    is_node: function (element) {\n      if (element == null) {\n        return false;\n      }\n      var tagName = element.tagName.toLowerCase();\n      if (tagName == 'jmnode') {\n        return true;\n      } else if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n        return false;\n      } else {\n        return this.is_node(element.parentElement);\n      }\n    },\n    is_expander: function (element) {\n      return element.tagName.toLowerCase() == 'jmexpander';\n    },\n    reset: function () {\n      logger.debug('view.reset');\n      this.selected_node = null;\n      this.clear_lines();\n      this.clear_nodes();\n      this.reset_theme();\n    },\n    reset_theme: function () {\n      var theme_name = this.jm.options.theme;\n      if (!!theme_name) {\n        this.e_nodes.className = 'theme-' + theme_name;\n      } else {\n        this.e_nodes.className = '';\n      }\n    },\n    reset_custom_style: function () {\n      var nodes = this.jm.mind.nodes;\n      for (var nodeid in nodes) {\n        this.reset_node_custom_style(nodes[nodeid]);\n      }\n    },\n    load: function () {\n      logger.debug('view.load');\n      this.init_nodes();\n    },\n    expand_size: function () {\n      var min_size = this.layout.get_min_size();\n      var min_width = min_size.w + this.opts.hmargin * 2;\n      var min_height = min_size.h + this.opts.vmargin * 2;\n      var client_w = this.e_panel.clientWidth;\n      var client_h = this.e_panel.clientHeight;\n      if (client_w < min_width) {\n        client_w = min_width;\n      }\n      if (client_h < min_height) {\n        client_h = min_height;\n      }\n      this.size.w = client_w;\n      this.size.h = client_h;\n    },\n    init_nodes_size: function (node) {\n      var view_data = node._data.view;\n      view_data.width = view_data.element.clientWidth;\n      view_data.height = view_data.element.clientHeight;\n    },\n    init_nodes: function () {\n      var nodes = this.jm.mind.nodes;\n      var doc_frag = $d.createDocumentFragment();\n      for (var nodeid in nodes) {\n        this.create_node_element(nodes[nodeid], doc_frag);\n      }\n      this.e_nodes.appendChild(doc_frag);\n      for (var nodeid in nodes) {\n        this.init_nodes_size(nodes[nodeid]);\n      }\n    },\n    add_node: function (node) {\n      this.create_node_element(node, this.e_nodes);\n      this.init_nodes_size(node);\n    },\n    create_node_element: function (node, parent_node) {\n      var view_data = null;\n      if ('view' in node._data) {\n        view_data = node._data.view;\n      } else {\n        view_data = {};\n        node._data.view = view_data;\n      }\n      var d = $c('jmnode');\n      if (node.isroot) {\n        d.className = 'root';\n      } else {\n        var d_e = $c('jmexpander');\n        $t(d_e, '-');\n        d_e.setAttribute('nodeid', node.id);\n        d_e.style.visibility = 'hidden';\n        parent_node.appendChild(d_e);\n        view_data.expander = d_e;\n      }\n      if (!!node.topic) {\n        if (this.opts.support_html) {\n          $h(d, node.topic);\n        } else {\n          $t(d, node.topic);\n        }\n      }\n      d.setAttribute('nodeid', node.id);\n      d.style.visibility = 'hidden';\n      this._reset_node_custom_style(d, node.data);\n      parent_node.appendChild(d);\n      view_data.element = d;\n    },\n    remove_node: function (node) {\n      if (this.selected_node != null && this.selected_node.id == node.id) {\n        this.selected_node = null;\n      }\n      if (this.editing_node != null && this.editing_node.id == node.id) {\n        node._data.view.element.removeChild(this.e_editor);\n        this.editing_node = null;\n      }\n      var children = node.children;\n      var i = children.length;\n      while (i--) {\n        this.remove_node(children[i]);\n      }\n      if (node._data.view) {\n        var element = node._data.view.element;\n        var expander = node._data.view.expander;\n        this.e_nodes.removeChild(element);\n        this.e_nodes.removeChild(expander);\n        node._data.view.element = null;\n        node._data.view.expander = null;\n      }\n    },\n    update_node: function (node) {\n      var view_data = node._data.view;\n      var element = view_data.element;\n      if (!!node.topic) {\n        if (this.opts.support_html) {\n          $h(element, node.topic);\n        } else {\n          $t(element, node.topic);\n        }\n      }\n      if (this.layout.is_visible(node)) {\n        view_data.width = element.clientWidth;\n        view_data.height = element.clientHeight;\n      } else {\n        let origin_style = element.getAttribute('style');\n        element.style = 'visibility: visible; left:0; top:0;';\n        view_data.width = element.clientWidth;\n        view_data.height = element.clientHeight;\n        element.style = origin_style;\n      }\n    },\n    select_node: function (node) {\n      if (!!this.selected_node) {\n        this.selected_node._data.view.element.className = this.selected_node._data.view.element.className.replace(/\\s*selected\\b/i, '');\n        this.reset_node_custom_style(this.selected_node);\n      }\n      if (!!node) {\n        this.selected_node = node;\n        node._data.view.element.className += ' selected';\n        this.clear_node_custom_style(node);\n      }\n    },\n    select_clear: function () {\n      this.select_node(null);\n    },\n    get_editing_node: function () {\n      return this.editing_node;\n    },\n    is_editing: function () {\n      return !!this.editing_node;\n    },\n    edit_node_begin: function (node) {\n      if (!node.topic) {\n        logger.warn(\"don't edit image nodes\");\n        return;\n      }\n      if (this.editing_node != null) {\n        this.edit_node_end();\n      }\n      this.editing_node = node;\n      var view_data = node._data.view;\n      var element = view_data.element;\n      var topic = node.topic;\n      var ncs = getComputedStyle(element);\n      this.e_editor.value = topic;\n      this.e_editor.style.width = element.clientWidth - parseInt(ncs.getPropertyValue('padding-left')) - parseInt(ncs.getPropertyValue('padding-right')) + 'px';\n      element.innerHTML = '';\n      element.appendChild(this.e_editor);\n      element.style.zIndex = 5;\n      this.e_editor.focus();\n      this.e_editor.select();\n    },\n    edit_node_end: function () {\n      if (this.editing_node != null) {\n        var node = this.editing_node;\n        this.editing_node = null;\n        var view_data = node._data.view;\n        var element = view_data.element;\n        var topic = this.e_editor.value;\n        element.style.zIndex = 'auto';\n        element.removeChild(this.e_editor);\n        if (jm.util.text.is_empty(topic) || node.topic === topic) {\n          if (this.opts.support_html) {\n            $h(element, node.topic);\n          } else {\n            $t(element, node.topic);\n          }\n        } else {\n          this.jm.update_node(node.id, topic);\n        }\n      }\n      this.e_panel.focus();\n    },\n    get_view_offset: function () {\n      var bounds = this.layout.bounds;\n      var _x = (this.size.w - bounds.e - bounds.w) / 2;\n      var _y = this.size.h / 2;\n      return {\n        x: _x,\n        y: _y\n      };\n    },\n    resize: function () {\n      this.graph.set_size(1, 1);\n      this.e_nodes.style.width = '1px';\n      this.e_nodes.style.height = '1px';\n      this.expand_size();\n      this._show();\n    },\n    _show: function () {\n      this.graph.set_size(this.size.w, this.size.h);\n      this.e_nodes.style.width = this.size.w + 'px';\n      this.e_nodes.style.height = this.size.h + 'px';\n      this.show_nodes();\n      this.show_lines();\n      //this.layout.cache_valid = true;\n      this.jm.invoke_event_handle(jm.event_type.resize, {\n        data: []\n      });\n    },\n    zoomIn: function () {\n      return this.setZoom(this.actualZoom + this.zoomStep);\n    },\n    zoomOut: function () {\n      return this.setZoom(this.actualZoom - this.zoomStep);\n    },\n    setZoom: function (zoom) {\n      if (zoom < this.minZoom || zoom > this.maxZoom) {\n        return false;\n      }\n      this.actualZoom = zoom;\n      for (var i = 0; i < this.e_panel.children.length; i++) {\n        this.e_panel.children[i].style.zoom = zoom;\n      }\n      ;\n      this.show(true);\n      return true;\n    },\n    _center_root: function () {\n      // center root node\n      var outer_w = this.e_panel.clientWidth;\n      var outer_h = this.e_panel.clientHeight;\n      if (this.size.w > outer_w) {\n        var _offset = this.get_view_offset();\n        this.e_panel.scrollLeft = _offset.x * this.actualZoom - outer_w / 2;\n      }\n      if (this.size.h > outer_h) {\n        this.e_panel.scrollTop = (this.size.h * this.actualZoom - outer_h) / 2;\n      }\n    },\n    show: function (keep_center) {\n      logger.debug('view.show');\n      this.expand_size();\n      this._show();\n      if (!!keep_center) {\n        this._center_root();\n      }\n    },\n    relayout: function () {\n      this.expand_size();\n      this._show();\n    },\n    save_location: function (node) {\n      var vd = node._data.view;\n      vd._saved_location = {\n        x: parseInt(vd.element.style.left) - this.e_panel.scrollLeft,\n        y: parseInt(vd.element.style.top) - this.e_panel.scrollTop\n      };\n    },\n    restore_location: function (node) {\n      var vd = node._data.view;\n      this.e_panel.scrollLeft = parseInt(vd.element.style.left) - vd._saved_location.x;\n      this.e_panel.scrollTop = parseInt(vd.element.style.top) - vd._saved_location.y;\n    },\n    clear_nodes: function () {\n      var mind = this.jm.mind;\n      if (mind == null) {\n        return;\n      }\n      var nodes = mind.nodes;\n      var node = null;\n      for (var nodeid in nodes) {\n        node = nodes[nodeid];\n        node._data.view.element = null;\n        node._data.view.expander = null;\n      }\n      this.e_nodes.innerHTML = '';\n    },\n    show_nodes: function () {\n      var nodes = this.jm.mind.nodes;\n      var node = null;\n      var node_element = null;\n      var expander = null;\n      var p = null;\n      var p_expander = null;\n      var expander_text = '-';\n      var view_data = null;\n      var _offset = this.get_view_offset();\n      for (var nodeid in nodes) {\n        node = nodes[nodeid];\n        view_data = node._data.view;\n        node_element = view_data.element;\n        expander = view_data.expander;\n        if (!this.layout.is_visible(node)) {\n          node_element.style.display = 'none';\n          expander.style.display = 'none';\n          continue;\n        }\n        this.reset_node_custom_style(node);\n        p = this.layout.get_node_point(node);\n        view_data.abs_x = _offset.x + p.x;\n        view_data.abs_y = _offset.y + p.y;\n        node_element.style.left = _offset.x + p.x + 'px';\n        node_element.style.top = _offset.y + p.y + 'px';\n        node_element.style.display = '';\n        node_element.style.visibility = 'visible';\n        if (!node.isroot && node.children.length > 0) {\n          expander_text = node.expanded ? '-' : '+';\n          p_expander = this.layout.get_expander_point(node);\n          expander.style.left = _offset.x + p_expander.x + 'px';\n          expander.style.top = _offset.y + p_expander.y + 'px';\n          expander.style.display = '';\n          expander.style.visibility = 'visible';\n          $t(expander, expander_text);\n        }\n        // hide expander while all children have been removed\n        if (!node.isroot && node.children.length == 0) {\n          expander.style.display = 'none';\n          expander.style.visibility = 'hidden';\n        }\n      }\n    },\n    reset_node_custom_style: function (node) {\n      this._reset_node_custom_style(node._data.view.element, node.data);\n    },\n    _reset_node_custom_style: function (node_element, node_data) {\n      if ('background-color' in node_data) {\n        node_element.style.backgroundColor = node_data['background-color'];\n      }\n      if ('foreground-color' in node_data) {\n        node_element.style.color = node_data['foreground-color'];\n      }\n      if ('width' in node_data) {\n        node_element.style.width = node_data['width'] + 'px';\n      }\n      if ('height' in node_data) {\n        node_element.style.height = node_data['height'] + 'px';\n      }\n      if ('font-size' in node_data) {\n        node_element.style.fontSize = node_data['font-size'] + 'px';\n      }\n      if ('font-weight' in node_data) {\n        node_element.style.fontWeight = node_data['font-weight'];\n      }\n      if ('font-style' in node_data) {\n        node_element.style.fontStyle = node_data['font-style'];\n      }\n      if ('background-image' in node_data) {\n        var backgroundImage = node_data['background-image'];\n        if (backgroundImage.startsWith('data') && node_data['width'] && node_data['height']) {\n          var img = new Image();\n          img.onload = function () {\n            var c = $c('canvas');\n            c.width = node_element.clientWidth;\n            c.height = node_element.clientHeight;\n            var img = this;\n            if (c.getContext) {\n              var ctx = c.getContext('2d');\n              ctx.drawImage(img, 2, 2, node_element.clientWidth, node_element.clientHeight);\n              var scaledImageData = c.toDataURL();\n              node_element.style.backgroundImage = 'url(' + scaledImageData + ')';\n            }\n          };\n          img.src = backgroundImage;\n        } else {\n          node_element.style.backgroundImage = 'url(' + backgroundImage + ')';\n        }\n        node_element.style.backgroundSize = '99%';\n        if ('background-rotation' in node_data) {\n          node_element.style.transform = 'rotate(' + node_data['background-rotation'] + 'deg)';\n        }\n      }\n    },\n    clear_node_custom_style: function (node) {\n      var node_element = node._data.view.element;\n      node_element.style.backgroundColor = \"\";\n      node_element.style.color = \"\";\n    },\n    clear_lines: function () {\n      this.graph.clear();\n    },\n    show_lines: function () {\n      this.clear_lines();\n      var nodes = this.jm.mind.nodes;\n      var node = null;\n      var pin = null;\n      var pout = null;\n      var _offset = this.get_view_offset();\n      for (var nodeid in nodes) {\n        node = nodes[nodeid];\n        if (!!node.isroot) {\n          continue;\n        }\n        if ('visible' in node._data.layout && !node._data.layout.visible) {\n          continue;\n        }\n        pin = this.layout.get_node_point_in(node);\n        pout = this.layout.get_node_point_out(node.parent);\n        this.graph.draw_line(pout, pin, _offset);\n      }\n    },\n    // Drag the whole mind map with your mouse (usefull when it's larger that the container).\n    draggable_canvas: function () {\n      // If draggable option is true.\n      if (this.opts.draggable) {\n        // Dragging disabled by default.\n        let dragging = false;\n        let x, y;\n        if (this.opts.hide_scrollbars_when_draggable) {\n          // Avoid scrollbars when mind map is larger than the container (e_panel = id jsmind-inner)\n          this.e_panel.style = 'overflow: hidden';\n        }\n        // Move the whole mind map with mouse moves, while button is down.\n        jm.util.dom.add_event(this.container, 'mousedown', eventDown => {\n          dragging = true;\n          // Record current mouse position.\n          x = eventDown.clientX;\n          y = eventDown.clientY;\n        });\n        // Stop moving mind map once mouse button is released.\n        jm.util.dom.add_event(this.container, 'mouseup', () => {\n          dragging = false;\n        });\n        // Follow current mouse position and move mind map accordingly.\n        jm.util.dom.add_event(this.container, 'mousemove', eventMove => {\n          if (this.dragging_enabled && dragging) {\n            this.e_panel.scrollBy(x - eventMove.clientX, y - eventMove.clientY);\n            // Record new current position.\n            x = eventMove.clientX;\n            y = eventMove.clientY;\n          }\n        });\n      }\n    },\n    get_draggable_canvas: function () {\n      return this.opts.draggable;\n    },\n    enable_draggable_canvas: function () {\n      this.dragging_enabled = true;\n    },\n    disable_draggable_canvas: function () {\n      this.dragging_enabled = false;\n    }\n  };\n\n  // shortcut provider\n  jm.shortcut_provider = function (jm, options) {\n    this.jm = jm;\n    this.opts = options;\n    this.mapping = options.mapping;\n    this.handles = options.handles;\n    this._newid = null;\n    this._mapping = {};\n  };\n  jm.shortcut_provider.prototype = {\n    init: function () {\n      jm.util.dom.add_event(this.jm.view.e_panel, 'keydown', this.handler.bind(this));\n      this.handles['addchild'] = this.handle_addchild;\n      this.handles['addbrother'] = this.handle_addbrother;\n      this.handles['editnode'] = this.handle_editnode;\n      this.handles['delnode'] = this.handle_delnode;\n      this.handles['toggle'] = this.handle_toggle;\n      this.handles['up'] = this.handle_up;\n      this.handles['down'] = this.handle_down;\n      this.handles['left'] = this.handle_left;\n      this.handles['right'] = this.handle_right;\n      for (var handle in this.mapping) {\n        if (!!this.mapping[handle] && handle in this.handles) {\n          var keys = this.mapping[handle];\n          if (!Array.isArray(keys)) {\n            keys = [keys];\n          }\n          for (let key of keys) {\n            this._mapping[key] = this.handles[handle];\n          }\n        }\n      }\n      if (typeof this.opts.id_generator === 'function') {\n        this._newid = this.opts.id_generator;\n      } else {\n        this._newid = jm.util.uuid.newid;\n      }\n    },\n    enable_shortcut: function () {\n      this.opts.enable = true;\n    },\n    disable_shortcut: function () {\n      this.opts.enable = false;\n    },\n    handler: function (e) {\n      if (e.which == 9) {\n        e.preventDefault();\n      } //prevent tab to change focus in browser\n      if (this.jm.view.is_editing()) {\n        return;\n      }\n      var evt = e || event;\n      if (!this.opts.enable) {\n        return true;\n      }\n      var kc = evt.keyCode + (evt.metaKey << 13) + (evt.ctrlKey << 12) + (evt.altKey << 11) + (evt.shiftKey << 10);\n      if (kc in this._mapping) {\n        this._mapping[kc].call(this, this.jm, e);\n      }\n    },\n    handle_addchild: function (_jm, e) {\n      var selected_node = _jm.get_selected_node();\n      if (!!selected_node) {\n        var nodeid = this._newid();\n        var node = _jm.add_node(selected_node, nodeid, 'New Node');\n        if (!!node) {\n          _jm.select_node(nodeid);\n          _jm.begin_edit(nodeid);\n        }\n      }\n    },\n    handle_addbrother: function (_jm, e) {\n      var selected_node = _jm.get_selected_node();\n      if (!!selected_node && !selected_node.isroot) {\n        var nodeid = this._newid();\n        var node = _jm.insert_node_after(selected_node, nodeid, 'New Node');\n        if (!!node) {\n          _jm.select_node(nodeid);\n          _jm.begin_edit(nodeid);\n        }\n      }\n    },\n    handle_editnode: function (_jm, e) {\n      var selected_node = _jm.get_selected_node();\n      if (!!selected_node) {\n        _jm.begin_edit(selected_node);\n      }\n    },\n    handle_delnode: function (_jm, e) {\n      var selected_node = _jm.get_selected_node();\n      if (!!selected_node && !selected_node.isroot) {\n        _jm.select_node(selected_node.parent);\n        _jm.remove_node(selected_node);\n      }\n    },\n    handle_toggle: function (_jm, e) {\n      var evt = e || event;\n      var selected_node = _jm.get_selected_node();\n      if (!!selected_node) {\n        _jm.toggle_node(selected_node.id);\n        evt.stopPropagation();\n        evt.preventDefault();\n      }\n    },\n    handle_up: function (_jm, e) {\n      var evt = e || event;\n      var selected_node = _jm.get_selected_node();\n      if (!!selected_node) {\n        var up_node = _jm.find_node_before(selected_node);\n        if (!up_node) {\n          var np = _jm.find_node_before(selected_node.parent);\n          if (!!np && np.children.length > 0) {\n            up_node = np.children[np.children.length - 1];\n          }\n        }\n        if (!!up_node) {\n          _jm.select_node(up_node);\n        }\n        evt.stopPropagation();\n        evt.preventDefault();\n      }\n    },\n    handle_down: function (_jm, e) {\n      var evt = e || event;\n      var selected_node = _jm.get_selected_node();\n      if (!!selected_node) {\n        var down_node = _jm.find_node_after(selected_node);\n        if (!down_node) {\n          var np = _jm.find_node_after(selected_node.parent);\n          if (!!np && np.children.length > 0) {\n            down_node = np.children[0];\n          }\n        }\n        if (!!down_node) {\n          _jm.select_node(down_node);\n        }\n        evt.stopPropagation();\n        evt.preventDefault();\n      }\n    },\n    handle_left: function (_jm, e) {\n      this._handle_direction(_jm, e, jm.direction.left);\n    },\n    handle_right: function (_jm, e) {\n      this._handle_direction(_jm, e, jm.direction.right);\n    },\n    _handle_direction: function (_jm, e, d) {\n      var evt = e || event;\n      var selected_node = _jm.get_selected_node();\n      var node = null;\n      if (!!selected_node) {\n        if (selected_node.isroot) {\n          var c = selected_node.children;\n          var children = [];\n          for (var i = 0; i < c.length; i++) {\n            if (c[i].direction === d) {\n              children.push(i);\n            }\n          }\n          node = c[children[Math.floor((children.length - 1) / 2)]];\n        } else if (selected_node.direction === d) {\n          var children = selected_node.children;\n          var childrencount = children.length;\n          if (childrencount > 0) {\n            node = children[Math.floor((childrencount - 1) / 2)];\n          }\n        } else {\n          node = selected_node.parent;\n        }\n        if (!!node) {\n          _jm.select_node(node);\n        }\n        evt.stopPropagation();\n        evt.preventDefault();\n      }\n    }\n  };\n\n  // plugin\n  jm.plugin = function (name, init) {\n    this.name = name;\n    this.init = init;\n  };\n  jm.plugins = [];\n  jm.register_plugin = function (plugin) {\n    if (plugin instanceof jm.plugin) {\n      jm.plugins.push(plugin);\n    }\n  };\n  jm.init_plugins = function (sender) {\n    $w.setTimeout(function () {\n      jm._init_plugins(sender);\n    }, 0);\n  };\n  jm._init_plugins = function (sender) {\n    var l = jm.plugins.length;\n    var fn_init = null;\n    for (var i = 0; i < l; i++) {\n      fn_init = jm.plugins[i].init;\n      if (typeof fn_init === 'function') {\n        fn_init(sender);\n      }\n    }\n  };\n  jm.show = function (options, mind) {\n    logger.warn('`jsMind.show(options, mind)` is deprecated, please use `jm = new jsMind(options); jm.show(mind);` instead');\n    var _jm = new jm(options);\n    _jm.show(mind);\n    return _jm;\n  };\n\n  // export jsmind\n  if (typeof module !== 'undefined' && typeof exports === 'object') {\n    module.exports = jm;\n  } else if (typeof define === 'function' && (define.amd || define.cmd)) {\n    define(function () {\n      return jm;\n    });\n  } else {\n    $w[__name__] = jm;\n  }\n})(typeof window !== 'undefined' ? window : global);","map":{"version":3,"names":["$w","console","warn","__name__","__version__","__author__","_noop","logger","log","debug","error","info","module","exports","$d","document","$g","id","getElementById","$c","tag","createElement","$t","n","t","hasChildNodes","firstChild","nodeValue","appendChild","createTextNode","$h","HTMLElement","innerHTML","$i","el","nodeType","style","ownerDocument","String","prototype","startsWith","p","slice","length","DEFAULT_OPTIONS","container","editable","theme","mode","support_html","view","engine","hmargin","vmargin","line_width","line_color","draggable","hide_scrollbars_when_draggable","node_overflow","layout","hspace","vspace","pspace","cousin_space","default_event_handle","enable_mousedown_handle","enable_click_handle","enable_dblclick_handle","enable_mousewheel_handle","shortcut","enable","handles","mapping","addchild","addbrother","editnode","delnode","toggle","left","up","right","down","jm","options","current","version","opts","util","json","merge","initialized","mind","event_handles","init","direction","center","of","dir","parseInt","toLowerCase","event_type","show","resize","edit","select","key","meta","ctrl","alt","shift","node","sId","iIndex","sTopic","oData","bIsRoot","oParent","eDirection","bExpanded","index","topic","data","isroot","parent","expanded","children","_data","compare","node1","node2","r","i1","i2","inherited","pnode","pid","is_node","get_location","vd","x","abs_x","y","abs_y","get_size","w","width","h","height","name","author","root","selected","nodes","get_node","nodeid","set_root","_put_node","add_node","parent_node","idx","node_index","push","_reindex","insert_node_before","node_before","get_node_before","the_node","insert_node_after","node_after","get_node_after","brothers","move_node","before_id","parent_id","_move_node","_flow_node_direction","len","_move_node_internal","beforeid","parentid","sibling","si","splice","remove_node","ci","k","sort","i","format","node_tree","example","get_mind","source","df","_parse","get_data","_buildnode","node_root","_extract_data","_extract_subnode","node_json","node_parent","d","o","node_data","node_array","_array","narray","reverse","root_node","_extract_root","root_json","extract_count","node_direction","sub_extract_count","_array_node","freemind","xml","xml_doc","_parse_xml","xml_root","_find_root","_load_node","xmllines","_buildmap","join","window","DOMParser","parser","parseFromString","ActiveXObject","async","loadXML","childNodes","tagName","ns","xml_node","node_id","getAttribute","node_topic","topic_children","topic_child","textContent","_load_attributes","node_expanded","node_position","child","attr","attr_data","pos","ajax","request","url","param","method","callback","fail_callback","a","tmp_param","encodeURIComponent","xhr","XMLHttpRequest","onreadystatechange","readyState","status","string2json","responseText","open","setRequestHeader","send","get","post","dom","add_event","e","addEventListener","attachEvent","file","read","file_data","fn_callback","reader","FileReader","onload","result","readAsText","save","type","blob","Blob","BlobBuilder","MozBlobBuilder","WebKitBlobBuilder","MSBlobBuilder","bb","append","getBlob","navigator","msSaveBlob","URL","webkitURL","bloburl","createObjectURL","anchor","visibility","href","download","body","evt","createEvent","initEvent","dispatchEvent","removeChild","location","json2string","JSON","stringify","json_str","parse","b","Object","toString","call","uuid","newid","Date","getTime","Math","random","substring","text","is_empty","s","replace","opts_layout","opts_view","data_provider","layout_provider","view_provider","shortcut_provider","_event_bind","init_plugins","enable_edit","disable_edit","enable_event_handle","event_handle","disable_event_handle","get_editable","set_theme","theme_old","reset_theme","reset_custom_style","mousedown_handle","click_handle","dblclick_handle","mousewheel_handle","element","target","event","srcElement","get_binded_nodeid","select_node","select_clear","is_expander","toggle_node","begin_edit","ctrlKey","preventDefault","deltaY","zoomIn","zoomOut","edit_node_begin","end_edit","edit_node_end","save_location","relayout","restore_location","expand_node","collapse_node","expand_all","collapse_all","expand_to_depth","depth","_reset","reset","_show","m","load","invoke_event_handle","get_meta","data_format","get_root","the_parent_node","undefined","calculate_next_child_direction","reset_node_custom_style","the_node_before","the_node_after","update_node","updated_node","is_visible","get_selected_node","is_node_visible","find_node_before","c","prev","ni","find_node_after","getthis","set_node_color","bgcolor","fgcolor","set_node_font_style","size","weight","set_node_background_image","image","rotation","set_node_background_rotation","add_event_listener","clear_event_listener","j","setTimeout","_invoke_event_handle","l","mind_data","isside","bounds","cache_valid","children_len","layout_direction","layout_offset","_layout_direction_root","layout_data","children_count","side_index","_layout_direction_side","subnode","offset_x","offset_y","outer_height","left_nodes","right_nodes","unshift","outer_height_left","_layout_offset_subnodes","outer_height_right","max","total_height","nodes_count","node_outer_height","base_y","pd","set_visible","middle_height","_layout_offset_subnodes_height","get_node_offset","offset_cache","_offset_","offset_p","get_node_point","view_data","get_node_point_in","get_node_point_out","pout_cache","_pout_","get_expander_point","ex_p","ceil","get_min_size","pout","part_layout","target_depth","curr_nodes","curr_depth","root_layout_data","visible","is_expand","graph_canvas","e_canvas","className","canvas_ctx","getContext","set_size","clear","clearRect","draw_line","pin","offset","ctx","strokeStyle","lineWidth","lineCap","_bezier_to","copy_to","dest_canvas_ctx","drawImage","x1","y1","x2","y2","beginPath","moveTo","bezierCurveTo","stroke","_line_to","lineTo","graph_svg","e_svg","setAttribute","lines","createElementNS","line","img","Image","src","btoa","XMLSerializer","serializeToString","path","e_panel","e_nodes","selected_node","editing_node","graph","e_editor","tabIndex","actualZoom","zoomStep","minZoom","maxZoom","v","keyCode","stopPropagation","dragging_enabled","draggable_canvas","obj","event_name","parentElement","clear_lines","clear_nodes","theme_name","init_nodes","expand_size","min_size","min_width","min_height","client_w","clientWidth","client_h","clientHeight","init_nodes_size","doc_frag","createDocumentFragment","create_node_element","d_e","expander","_reset_node_custom_style","origin_style","clear_node_custom_style","get_editing_node","is_editing","ncs","getComputedStyle","value","getPropertyValue","zIndex","focus","get_view_offset","_x","_y","show_nodes","show_lines","setZoom","zoom","_center_root","outer_w","outer_h","_offset","scrollLeft","scrollTop","keep_center","_saved_location","top","node_element","p_expander","expander_text","display","backgroundColor","color","fontSize","fontWeight","fontStyle","backgroundImage","scaledImageData","toDataURL","backgroundSize","transform","dragging","eventDown","clientX","clientY","eventMove","scrollBy","get_draggable_canvas","enable_draggable_canvas","disable_draggable_canvas","_newid","_mapping","handler","bind","handle_addchild","handle_addbrother","handle_editnode","handle_delnode","handle_toggle","handle_up","handle_down","handle_left","handle_right","handle","keys","Array","isArray","id_generator","enable_shortcut","disable_shortcut","which","kc","metaKey","altKey","shiftKey","_jm","up_node","np","down_node","_handle_direction","floor","childrencount","plugin","plugins","register_plugin","sender","_init_plugins","fn_init","define","amd","cmd","global"],"sources":["E:/neuprogram-master2/neuprogram-master/node_modules/jsmind/js/jsmind.js"],"sourcesContent":["/**\n * @license BSD\n * @copyright 2014-2023 hizzgdev@163.com\n *\n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\n; (function ($w) {\n    'use strict';\n    console.warn(\"The version is outdated. see details: https://hizzgdev.github.io/jsmind/es6/README.md\")\n    // set 'jsMind' as the library name.\n    // __name__ should be a const value, Never try to change it easily.\n    var __name__ = 'jsMind';\n    // library version\n    var __version__ = '0.5.7';\n    // author\n    var __author__ = 'hizzgdev@163.com';\n\n    // an noop function define\n    var _noop = function () { };\n    var logger = (typeof console === 'undefined') ? {\n        log: _noop, debug: _noop, error: _noop, warn: _noop, info: _noop\n    } : console;\n\n    // check global variables\n    if (typeof module === 'undefined' || !module.exports) {\n        if (typeof $w[__name__] != 'undefined') {\n            logger.log(__name__ + ' has been already exist.');\n            return;\n        }\n    }\n\n    // shortcut of methods in dom\n    var $d = $w.document;\n    var $g = function (id) { return $d.getElementById(id); };\n    var $c = function (tag) { return $d.createElement(tag); };\n    var $t = function (n, t) { if (n.hasChildNodes()) { n.firstChild.nodeValue = t; } else { n.appendChild($d.createTextNode(t)); } };\n\n    var $h = function (n, t) {\n        if (t instanceof HTMLElement) {\n            n.innerHTML = '';\n            n.appendChild(t);\n        } else {\n            n.innerHTML = t;\n        }\n    };\n    // detect isElement\n    var $i = function (el) { return !!el && (typeof el === 'object') && (el.nodeType === 1) && (typeof el.style === 'object') && (typeof el.ownerDocument === 'object'); };\n    if (typeof String.prototype.startsWith != 'function') { String.prototype.startsWith = function (p) { return this.slice(0, p.length) === p; }; }\n\n    var DEFAULT_OPTIONS = {\n        container: '',   // id of the container\n        editable: false, // you can change it in your options\n        theme: null,\n        mode: 'full',    // full or side\n        support_html: true,\n\n        view: {\n            engine: 'canvas',\n            hmargin: 100,\n            vmargin: 50,\n            line_width: 2,\n            line_color: '#555',\n            draggable: false, // drag the mind map with your mouse, when it's larger that the container\n            hide_scrollbars_when_draggable: false, // hide container scrollbars, when mind map is larger than container and draggable option is true.\n            node_overflow: 'hidden' // hidden or wrap\n        },\n        layout: {\n            hspace: 30,\n            vspace: 20,\n            pspace: 13,\n            cousin_space: 0\n        },\n        default_event_handle: {\n            enable_mousedown_handle: true,\n            enable_click_handle: true,\n            enable_dblclick_handle: true,\n            enable_mousewheel_handle: true\n        },\n        shortcut: {\n            enable: true,\n            handles: {\n            },\n            mapping: {\n                addchild: [45, 4096+13], // Insert, Ctrl+Enter\n                addbrother: 13, // Enter\n                editnode: 113,// F2\n                delnode: 46, // Delete\n                toggle: 32, // Space\n                left: 37, // Left\n                up: 38, // Up\n                right: 39, // Right\n                down: 40, // Down\n            }\n        },\n    };\n\n    // core object\n    var jm = function (options) {\n        jm.current = this;\n\n        this.version = __version__;\n        var opts = {};\n        jm.util.json.merge(opts, DEFAULT_OPTIONS);\n        jm.util.json.merge(opts, options);\n\n        if (!opts.container) {\n            logger.error('the options.container should not be null or empty.');\n            return;\n        }\n        this.options = opts;\n        this.initialized = false;\n        this.mind = null;\n        this.event_handles = [];\n        this.init();\n    };\n\n    // ============= static object =============================================\n    jm.direction = {\n        left: -1, center: 0, right: 1, of: function (dir) {\n            if (!dir || dir === -1 || dir === 0 || dir === 1) {\n                return dir;\n            }\n            if (dir === '-1' || dir === '0' || dir === '1') {\n                return parseInt(dir);\n            }\n            if (dir.toLowerCase() === 'left') {\n                return this.left;\n            }\n            if (dir.toLowerCase() === 'right') {\n                return this.right;\n            }\n            if (dir.toLowerCase() === 'center') {\n                return this.center;\n            }\n        }\n    };\n    jm.event_type = { show: 1, resize: 2, edit: 3, select: 4 };\n    jm.key = { meta: 1 << 13, ctrl: 1 << 12, alt: 1 << 11, shift: 1 << 10 };\n\n    jm.node = function (sId, iIndex, sTopic, oData, bIsRoot, oParent, eDirection, bExpanded) {\n        if (!sId) { logger.error('invalid node id'); return; }\n        if (typeof iIndex != 'number') { logger.error('invalid node index'); return; }\n        if (typeof bExpanded === 'undefined') { bExpanded = true; }\n        this.id = sId;\n        this.index = iIndex;\n        this.topic = sTopic;\n        this.data = oData || {};\n        this.isroot = bIsRoot;\n        this.parent = oParent;\n        this.direction = eDirection;\n        this.expanded = !!bExpanded;\n        this.children = [];\n        this._data = {};\n    };\n\n    jm.node.compare = function (node1, node2) {\n        // '-1' is alwary the last\n        var r = 0;\n        var i1 = node1.index;\n        var i2 = node2.index;\n        if (i1 >= 0 && i2 >= 0) {\n            r = i1 - i2;\n        } else if (i1 == -1 && i2 == -1) {\n            r = 0;\n        } else if (i1 == -1) {\n            r = 1;\n        } else if (i2 == -1) {\n            r = -1;\n        } else {\n            r = 0;\n        }\n        //logger.debug(i1+' <> '+i2+'  =  '+r);\n        return r;\n    };\n\n    jm.node.inherited = function (pnode, node) {\n        if (!!pnode && !!node) {\n            if (pnode.id === node.id) {\n                return true;\n            }\n            if (pnode.isroot) {\n                return true;\n            }\n            var pid = pnode.id;\n            var p = node;\n            while (!p.isroot) {\n                p = p.parent;\n                if (p.id === pid) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    jm.node.is_node = function (n) {\n        return !!n && n instanceof jm.node;\n    };\n\n    jm.node.prototype = {\n        get_location: function () {\n            var vd = this._data.view;\n            return {\n                x: vd.abs_x,\n                y: vd.abs_y\n            };\n        },\n        get_size: function () {\n            var vd = this._data.view;\n            return {\n                w: vd.width,\n                h: vd.height\n            }\n        }\n    };\n\n\n    jm.mind = function () {\n        this.name = null;\n        this.author = null;\n        this.version = null;\n        this.root = null;\n        this.selected = null;\n        this.nodes = {};\n    };\n\n    jm.mind.prototype = {\n        get_node: function (nodeid) {\n            if (nodeid in this.nodes) {\n                return this.nodes[nodeid];\n            } else {\n                logger.warn('the node[id=' + nodeid + '] can not be found');\n                return null;\n            }\n        },\n\n        set_root: function (nodeid, topic, data) {\n            if (this.root == null) {\n                this.root = new jm.node(nodeid, 0, topic, data, true);\n                this._put_node(this.root);\n                return this.root;\n            } else {\n                logger.error('root node is already exist');\n                return null;\n            }\n        },\n\n        add_node: function (parent_node, nodeid, topic, data, direction, expanded, idx) {\n            if (!jm.util.is_node(parent_node)) {\n                logger.error('the parent_node ' + parent_node + ' is not a node.');\n                return null;\n            }\n            var node_index = idx || -1;\n            var node = new jm.node(nodeid, node_index, topic, data, false, parent_node, parent_node.direction, expanded);\n            if (parent_node.isroot) {\n                node.direction = direction || jm.direction.right;\n            }\n            if (this._put_node(node)) {\n                parent_node.children.push(node);\n                this._reindex(parent_node);\n            } else {\n                logger.error('fail, the nodeid \\'' + node.id + '\\' has been already exist.');\n                node = null;\n            }\n            return node;\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data, direction) {\n            if (!jm.util.is_node(node_before)) {\n                logger.error('the node_before ' + node_before + ' is not a node.');\n                return null;\n            }\n            var node_index = node_before.index - 0.5;\n            return this.add_node(node_before.parent, nodeid, topic, data, direction, true, node_index);\n        },\n\n        get_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index - 2;\n            if (idx >= 0) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data, direction) {\n            if (!jm.util.is_node(node_after)) {\n                logger.error('the node_after ' + node_after + ' is not a node.');\n                return null;\n            }\n            var node_index = node_after.index + 0.5;\n            return this.add_node(node_after.parent, nodeid, topic, data, direction, true, node_index);\n        },\n\n        get_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index;\n            var brothers = node.parent.children;\n            if (brothers.length > idx) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        move_node: function (node, before_id, parent_id, direction) {\n            if (!jm.util.is_node(node)) {\n                logger.error('the parameter node ' + node + ' is not a node.');\n                return null;\n            }\n            if (!parent_id) {\n                parent_id = node.parent.id;\n            }\n            return this._move_node(node, before_id, parent_id, direction);\n        },\n\n        _flow_node_direction: function (node, direction) {\n            if (typeof direction === 'undefined') {\n                direction = node.direction;\n            } else {\n                node.direction = direction;\n            }\n            var len = node.children.length;\n            while (len--) {\n                this._flow_node_direction(node.children[len], direction);\n            }\n        },\n\n        _move_node_internal: function (node, beforeid) {\n            if (!!node && !!beforeid) {\n                if (beforeid == '_last_') {\n                    node.index = -1;\n                    this._reindex(node.parent);\n                } else if (beforeid == '_first_') {\n                    node.index = 0;\n                    this._reindex(node.parent);\n                } else {\n                    var node_before = (!!beforeid) ? this.get_node(beforeid) : null;\n                    if (node_before != null && node_before.parent != null && node_before.parent.id == node.parent.id) {\n                        node.index = node_before.index - 0.5;\n                        this._reindex(node.parent);\n                    }\n                }\n            }\n            return node;\n        },\n\n        _move_node: function (node, beforeid, parentid, direction) {\n            if (!!node && !!parentid) {\n                var parent_node = this.get_node(parentid)\n                if (jm.node.inherited(node, parent_node)) {\n                    logger.error('can not move a node to its children');\n                    return null;\n                }\n                if (node.parent.id != parentid) {\n                    // remove from parent's children\n                    var sibling = node.parent.children;\n                    var si = sibling.length;\n                    while (si--) {\n                        if (sibling[si].id == node.id) {\n                            sibling.splice(si, 1);\n                            break;\n                        }\n                    }\n                    node.parent = parent_node;\n                    parent_node.children.push(node);\n                }\n\n                if (node.parent.isroot) {\n                    if (direction == jm.direction.left) {\n                        node.direction = direction;\n                    } else {\n                        node.direction = jm.direction.right;\n                    }\n                } else {\n                    node.direction = node.parent.direction;\n                }\n                this._move_node_internal(node, beforeid);\n                this._flow_node_direction(node);\n            }\n            return node;\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                logger.error('the parameter node ' + node + ' is not a node.');\n                return false;\n            }\n            if (node.isroot) {\n                logger.error('fail, can not remove root node');\n                return false;\n            }\n            if (this.selected != null && this.selected.id == node.id) {\n                this.selected = null;\n            }\n            // clean all subordinate nodes\n            var children = node.children;\n            var ci = children.length;\n            while (ci--) {\n                this.remove_node(children[ci]);\n            }\n            // clean all children\n            children.length = 0;\n            // remove from parent's children\n            var sibling = node.parent.children;\n            var si = sibling.length;\n            while (si--) {\n                if (sibling[si].id == node.id) {\n                    sibling.splice(si, 1);\n                    break;\n                }\n            }\n            // remove from global nodes\n            delete this.nodes[node.id];\n            // clean all properties\n            for (var k in node) {\n                delete node[k];\n            }\n            // remove it's self\n            node = null;\n            //delete node;\n            return true;\n        },\n\n        _put_node: function (node) {\n            if (node.id in this.nodes) {\n                logger.warn('the nodeid \\'' + node.id + '\\' has been already exist.');\n                return false;\n            } else {\n                this.nodes[node.id] = node;\n                return true;\n            }\n        },\n\n        _reindex: function (node) {\n            if (node instanceof jm.node) {\n                node.children.sort(jm.node.compare);\n                for (var i = 0; i < node.children.length; i++) {\n                    node.children[i].index = i + 1;\n                }\n            }\n        },\n    };\n\n    jm.format = {\n        node_tree: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_tree\",\n                \"data\": { \"id\": \"root\", \"topic\": \"jsMind Example\" }\n            },\n            get_mind: function (source) {\n                var df = jm.format.node_tree;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n            get_data: function (mind) {\n                var df = jm.format.node_tree;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_tree';\n                json.data = df._buildnode(mind.root);\n                return json;\n            },\n\n            _parse: function (mind, node_root) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_root);\n                mind.set_root(node_root.id, node_root.topic, data);\n                if ('children' in node_root) {\n                    var children = node_root.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, mind.root, children[i]);\n                    }\n                }\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'children' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _extract_subnode: function (mind, node_parent, node_json) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_json);\n                var d = null;\n                if (node_parent.isroot) {\n                    d = node_json.direction == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                var node = mind.add_node(node_parent, node_json.id, node_json.topic, data, d, node_json.expanded);\n                if (!!node_json['children']) {\n                    var children = node_json.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, node, children[i]);\n                    }\n                }\n            },\n\n            _buildnode: function (node) {\n                var df = jm.format.node_tree;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                var children = node.children;\n                if (children.length > 0) {\n                    o.children = [];\n                    for (var i = 0; i < children.length; i++) {\n                        o.children.push(df._buildnode(children[i]));\n                    }\n                }\n                return o;\n            }\n        },\n\n        node_array: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_array\",\n                \"data\": [\n                    { \"id\": \"root\", \"topic\": \"jsMind Example\", \"isroot\": true }\n                ]\n            },\n\n            get_mind: function (source) {\n                var df = jm.format.node_array;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.node_array;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_array';\n                json.data = [];\n                df._array(mind, json.data);\n                return json;\n            },\n\n            _parse: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var narray = node_array.slice(0);\n                // reverse array for improving looping performance\n                narray.reverse();\n                var root_node = df._extract_root(mind, narray);\n                if (!!root_node) {\n                    df._extract_subnode(mind, root_node, narray);\n                } else {\n                    logger.error('root node can not be found');\n                }\n            },\n\n            _extract_root: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                while (i--) {\n                    if ('isroot' in node_array[i] && node_array[i].isroot) {\n                        var root_json = node_array[i];\n                        var data = df._extract_data(root_json);\n                        var node = mind.set_root(root_json.id, root_json.topic, data);\n                        node_array.splice(i, 1);\n                        return node;\n                    }\n                }\n                return null;\n            },\n\n            _extract_subnode: function (mind, parent_node, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                var node_json = null;\n                var data = null;\n                var extract_count = 0;\n                while (i--) {\n                    node_json = node_array[i];\n                    if (node_json.parentid == parent_node.id) {\n                        data = df._extract_data(node_json);\n                        var d = null;\n                        var node_direction = node_json.direction;\n                        if (!!node_direction) {\n                            d = node_direction == 'left' ? jm.direction.left : jm.direction.right;\n                        }\n                        var node = mind.add_node(parent_node, node_json.id, node_json.topic, data, d, node_json.expanded);\n                        node_array.splice(i, 1);\n                        extract_count++;\n                        var sub_extract_count = df._extract_subnode(mind, node, node_array);\n                        if (sub_extract_count > 0) {\n                            // reset loop index after extract subordinate node\n                            i = node_array.length;\n                            extract_count += sub_extract_count;\n                        }\n                    }\n                }\n                return extract_count;\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'parentid' || k == 'isroot' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _array: function (mind, node_array) {\n                var df = jm.format.node_array;\n                df._array_node(mind.root, node_array);\n            },\n\n            _array_node: function (node, node_array) {\n                var df = jm.format.node_array;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent) {\n                    o.parentid = node.parent.id;\n                }\n                if (node.isroot) {\n                    o.isroot = true;\n                }\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                node_array.push(o);\n                var ci = node.children.length;\n                for (var i = 0; i < ci; i++) {\n                    df._array_node(node.children[i], node_array);\n                }\n            },\n        },\n\n        freemind: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"freemind\",\n                \"data\": \"<map version=\\\"1.0.1\\\"><node ID=\\\"root\\\" TEXT=\\\"freemind Example\\\"/></map>\"\n            },\n            get_mind: function (source) {\n                var df = jm.format.freemind;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                var xml = source.data;\n                var xml_doc = df._parse_xml(xml);\n                var xml_root = df._find_root(xml_doc);\n                df._load_node(mind, null, xml_root);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.freemind;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'freemind';\n                var xmllines = [];\n                xmllines.push('<map version=\\\"1.0.1\\\">');\n                df._buildmap(mind.root, xmllines);\n                xmllines.push('</map>');\n                json.data = xmllines.join(' ');\n                return json;\n            },\n\n            _parse_xml: function (xml) {\n                var xml_doc = null;\n                if (window.DOMParser) {\n                    var parser = new DOMParser();\n                    xml_doc = parser.parseFromString(xml, 'text/xml');\n                } else { // Internet Explorer\n                    xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n                    xml_doc.async = false;\n                    xml_doc.loadXML(xml);\n                }\n                return xml_doc;\n            },\n\n            _find_root: function (xml_doc) {\n                var nodes = xml_doc.childNodes;\n                var node = null;\n                var root = null;\n                var n = null;\n                for (var i = 0; i < nodes.length; i++) {\n                    n = nodes[i];\n                    if (n.nodeType == 1 && n.tagName == 'map') {\n                        node = n;\n                        break;\n                    }\n                }\n                if (!!node) {\n                    var ns = node.childNodes;\n                    node = null;\n                    for (var i = 0; i < ns.length; i++) {\n                        n = ns[i];\n                        if (n.nodeType == 1 && n.tagName == 'node') {\n                            node = n;\n                            break;\n                        }\n                    }\n                }\n                return node;\n            },\n\n            _load_node: function (mind, parent_node, xml_node) {\n                var df = jm.format.freemind;\n                var node_id = xml_node.getAttribute('ID');\n                var node_topic = xml_node.getAttribute('TEXT');\n                // look for richcontent\n                if (node_topic == null) {\n                    var topic_children = xml_node.childNodes;\n                    var topic_child = null;\n                    for (var i = 0; i < topic_children.length; i++) {\n                        topic_child = topic_children[i];\n                        //logger.debug(topic_child.tagName);\n                        if (topic_child.nodeType == 1 && topic_child.tagName === 'richcontent') {\n                            node_topic = topic_child.textContent;\n                            break;\n                        }\n                    }\n                }\n                var node_data = df._load_attributes(xml_node);\n                var node_expanded = ('expanded' in node_data) ? (node_data.expanded == 'true') : true;\n                delete node_data.expanded;\n\n                var node_position = xml_node.getAttribute('POSITION');\n                var node_direction = null;\n                if (!!node_position) {\n                    node_direction = node_position == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                //logger.debug(node_position +':'+ node_direction);\n                var node = null;\n                if (!!parent_node) {\n                    node = mind.add_node(parent_node, node_id, node_topic, node_data, node_direction, node_expanded);\n                } else {\n                    node = mind.set_root(node_id, node_topic, node_data);\n                }\n                var children = xml_node.childNodes;\n                var child = null;\n                for (var i = 0; i < children.length; i++) {\n                    child = children[i];\n                    if (child.nodeType == 1 && child.tagName == 'node') {\n                        df._load_node(mind, node, child);\n                    }\n                }\n            },\n\n            _load_attributes: function (xml_node) {\n                var children = xml_node.childNodes;\n                var attr = null;\n                var attr_data = {};\n                for (var i = 0; i < children.length; i++) {\n                    attr = children[i];\n                    if (attr.nodeType == 1 && attr.tagName === 'attribute') {\n                        attr_data[attr.getAttribute('NAME')] = attr.getAttribute('VALUE');\n                    }\n                }\n                return attr_data;\n            },\n\n            _buildmap: function (node, xmllines) {\n                var df = jm.format.freemind;\n                var pos = null;\n                if (!!node.parent && node.parent.isroot) {\n                    pos = node.direction === jm.direction.left ? 'left' : 'right';\n                }\n                xmllines.push('<node');\n                xmllines.push('ID=\\\"' + node.id + '\\\"');\n                if (!!pos) {\n                    xmllines.push('POSITION=\\\"' + pos + '\\\"');\n                }\n                xmllines.push('TEXT=\\\"' + node.topic + '\\\">');\n\n                // store expanded status as an attribute\n                xmllines.push('<attribute NAME=\\\"expanded\\\" VALUE=\\\"' + node.expanded + '\\\"/>');\n\n                // for attributes\n                var node_data = node.data;\n                if (node_data != null) {\n                    for (var k in node_data) {\n                        xmllines.push('<attribute NAME=\\\"' + k + '\\\" VALUE=\\\"' + node_data[k] + '\\\"/>');\n                    }\n                }\n\n                // for children\n                var children = node.children;\n                for (var i = 0; i < children.length; i++) {\n                    df._buildmap(children[i], xmllines);\n                }\n\n                xmllines.push('</node>');\n            },\n        },\n    };\n\n    // ============= utility object =============================================\n\n    jm.util = {\n        is_node: function (node) {\n            return !!node && node instanceof jm.node;\n        },\n        ajax: {\n            request: function (url, param, method, callback, fail_callback) {\n                var a = jm.util.ajax;\n                var p = null;\n                var tmp_param = [];\n                for (var k in param) {\n                    tmp_param.push(encodeURIComponent(k) + '=' + encodeURIComponent(param[k]));\n                }\n                if (tmp_param.length > 0) {\n                    p = tmp_param.join('&');\n                }\n                var xhr = new XMLHttpRequest();\n                if (!xhr) { return; }\n                xhr.onreadystatechange = function () {\n                    if (xhr.readyState == 4) {\n                        if (xhr.status == 200 || xhr.status == 0) {\n                            if (typeof callback === 'function') {\n                                var data = jm.util.json.string2json(xhr.responseText);\n                                if (data != null) {\n                                    callback(data);\n                                } else {\n                                    callback(xhr.responseText);\n                                }\n                            }\n                        } else {\n                            if (typeof fail_callback === 'function') {\n                                fail_callback(xhr);\n                            } else {\n                                logger.error('xhr request failed.', xhr);\n                            }\n                        }\n                    }\n                }\n                method = method || 'GET';\n                xhr.open(method, url, true);\n                xhr.setRequestHeader('If-Modified-Since', '0');\n                if (method == 'POST') {\n                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');\n                    xhr.send(p);\n                } else {\n                    xhr.send();\n                }\n            },\n            get: function (url, callback) {\n                return jm.util.ajax.request(url, {}, 'GET', callback);\n            },\n            post: function (url, param, callback) {\n                return jm.util.ajax.request(url, param, 'POST', callback);\n            }\n        },\n\n        dom: {\n            //target,eventType,handler\n            add_event: function (t, e, h) {\n                if (!!t.addEventListener) {\n                    t.addEventListener(e, h, false);\n                } else {\n                    t.attachEvent('on' + e, h);\n                }\n            }\n        },\n\n        file: {\n            read: function (file_data, fn_callback) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    if (typeof fn_callback === 'function') {\n                        fn_callback(this.result, file_data.name);\n                    }\n                };\n                reader.readAsText(file_data);\n            },\n\n            save: function (file_data, type, name) {\n                var blob;\n                if (typeof $w.Blob === 'function') {\n                    blob = new Blob([file_data], { type: type });\n                } else {\n                    var BlobBuilder = $w.BlobBuilder || $w.MozBlobBuilder || $w.WebKitBlobBuilder || $w.MSBlobBuilder;\n                    var bb = new BlobBuilder();\n                    bb.append(file_data);\n                    blob = bb.getBlob(type);\n                }\n                if (navigator.msSaveBlob) {\n                    navigator.msSaveBlob(blob, name);\n                } else {\n                    var URL = $w.URL || $w.webkitURL;\n                    var bloburl = URL.createObjectURL(blob);\n                    var anchor = $c('a');\n                    if ('download' in anchor) {\n                        anchor.style.visibility = 'hidden';\n                        anchor.href = bloburl;\n                        anchor.download = name;\n                        $d.body.appendChild(anchor);\n                        var evt = $d.createEvent('MouseEvents');\n                        evt.initEvent('click', true, true);\n                        anchor.dispatchEvent(evt);\n                        $d.body.removeChild(anchor);\n                    } else {\n                        location.href = bloburl;\n                    }\n                }\n            }\n        },\n\n        json: {\n            json2string: function (json) {\n                return JSON.stringify(json);\n            },\n            string2json: function (json_str) {\n                return JSON.parse(json_str);\n            },\n            merge: function (b, a) {\n                for (var o in a) {\n                    if (o in b) {\n                        if (typeof b[o] === 'object' &&\n                            Object.prototype.toString.call(b[o]).toLowerCase() == '[object object]' &&\n                            !b[o].length) {\n                            jm.util.json.merge(b[o], a[o]);\n                        } else {\n                            b[o] = a[o];\n                        }\n                    } else {\n                        b[o] = a[o];\n                    }\n                }\n                return b;\n            }\n        },\n\n        uuid: {\n            newid: function () {\n                return (new Date().getTime().toString(16) + Math.random().toString(16).substring(2)).substring(2, 18);\n            }\n        },\n\n        text: {\n            is_empty: function (s) {\n                if (!s) { return true; }\n                return s.replace(/\\s*/, '').length == 0;\n            }\n        }\n    };\n\n    jm.prototype = {\n        init: function () {\n            if (this.initialized) { return; }\n            this.initialized = true;\n\n            var opts = this.options;\n\n            var opts_layout = {\n                mode: opts.mode,\n                hspace: opts.layout.hspace,\n                vspace: opts.layout.vspace,\n                pspace: opts.layout.pspace,\n                cousin_space: opts.layout.cousin_space\n            }\n            var opts_view = {\n                container: opts.container,\n                support_html: opts.support_html,\n                engine: opts.view.engine,\n                hmargin: opts.view.hmargin,\n                vmargin: opts.view.vmargin,\n                line_width: opts.view.line_width,\n                line_color: opts.view.line_color,\n                draggable: opts.view.draggable,\n                hide_scrollbars_when_draggable: opts.view.hide_scrollbars_when_draggable,\n                node_overflow: opts.view.node_overflow\n            };\n            // create instance of function provider\n            this.data = new jm.data_provider(this);\n            this.layout = new jm.layout_provider(this, opts_layout);\n            this.view = new jm.view_provider(this, opts_view);\n            this.shortcut = new jm.shortcut_provider(this, opts.shortcut);\n\n            this.data.init();\n            this.layout.init();\n            this.view.init();\n            this.shortcut.init();\n\n            this._event_bind();\n\n            jm.init_plugins(this);\n        },\n\n        enable_edit: function () {\n            this.options.editable = true;\n        },\n\n        disable_edit: function () {\n            this.options.editable = false;\n        },\n\n        // call enable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        enable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = true;\n        },\n\n        // call disable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        disable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = false;\n        },\n\n        get_editable: function () {\n            return this.options.editable;\n        },\n\n        set_theme: function (theme) {\n            var theme_old = this.options.theme;\n            this.options.theme = (!!theme) ? theme : null;\n            if (theme_old != this.options.theme) {\n                this.view.reset_theme();\n                this.view.reset_custom_style();\n            }\n        },\n        _event_bind: function () {\n            this.view.add_event(this, 'mousedown', this.mousedown_handle);\n            this.view.add_event(this, 'click', this.click_handle);\n            this.view.add_event(this, 'dblclick', this.dblclick_handle);\n            this.view.add_event(this, \"mousewheel\", this.mousewheel_handle)\n        },\n\n        mousedown_handle: function (e) {\n            if (!this.options.default_event_handle['enable_mousedown_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var nodeid = this.view.get_binded_nodeid(element);\n            if (!!nodeid) {\n                if (this.view.is_node(element)) {\n                    this.select_node(nodeid);\n                }\n            } else {\n                this.select_clear();\n            }\n        },\n\n        click_handle: function (e) {\n            if (!this.options.default_event_handle['enable_click_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var is_expander = this.view.is_expander(element);\n            if (is_expander) {\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.toggle_node(nodeid);\n                }\n            }\n        },\n\n        dblclick_handle: function (e) {\n            if (!this.options.default_event_handle['enable_dblclick_handle']) {\n                return;\n            }\n            if (this.get_editable()) {\n                var element = e.target || event.srcElement;\n                var is_node = this.view.is_node(element);\n                if (is_node) {\n                    var nodeid = this.view.get_binded_nodeid(element);\n                    if (!!nodeid) {\n                        this.begin_edit(nodeid);\n                    }\n                }\n            }\n        },\n\n        // Use [Ctrl] + Mousewheel, to zoom in/out.\n        mousewheel_handle: function (event) {\n            // Test if mousewheel option is enabled and Ctrl key is pressed.\n            if (!this.options.default_event_handle[\"enable_mousewheel_handle\"] || !window.event.ctrlKey) {\n                return\n            }\n            // Avoid default page scrolling behavior.\n            event.preventDefault()\n\n            if (event.deltaY < 0) {\n                this.view.zoomIn()\n            } else {\n                this.view.zoomOut()\n            }\n        },\n\n        begin_edit: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.begin_edit(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                this.view.edit_node_begin(node);\n            } else {\n                logger.error('fail, this mind map is not editable.');\n                return;\n            }\n        },\n\n        end_edit: function () {\n            this.view.edit_node_end();\n        },\n\n        toggle_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.toggle_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.toggle_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.expand_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.expand_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        collapse_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.collapse_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.collapse_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_all: function () {\n            this.layout.expand_all();\n            this.view.relayout();\n        },\n\n        collapse_all: function () {\n            this.layout.collapse_all();\n            this.view.relayout();\n        },\n\n        expand_to_depth: function (depth) {\n            this.layout.expand_to_depth(depth);\n            this.view.relayout();\n        },\n\n        _reset: function () {\n            this.view.reset();\n            this.layout.reset();\n            this.data.reset();\n        },\n\n        _show: function (mind) {\n            var m = mind || jm.format.node_array.example;\n\n            this.mind = this.data.load(m);\n            if (!this.mind) {\n                logger.error('data.load error');\n                return;\n            } else {\n                logger.debug('data.load ok');\n            }\n\n            this.view.load();\n            logger.debug('view.load ok');\n\n            this.layout.layout();\n            logger.debug('layout.layout ok');\n\n            this.view.show(true);\n            logger.debug('view.show ok');\n\n            this.invoke_event_handle(jm.event_type.show, { data: [mind] });\n        },\n\n        show: function (mind) {\n            this._reset();\n            this._show(mind);\n        },\n\n        get_meta: function () {\n            return {\n                name: this.mind.name,\n                author: this.mind.author,\n                version: this.mind.version\n            };\n        },\n\n        get_data: function (data_format) {\n            var df = data_format || 'node_tree';\n            return this.data.get_data(df);\n        },\n\n        get_root: function () {\n            return this.mind.root;\n        },\n\n        get_node: function (node) {\n            if (jm.util.is_node(node)) {\n                return node;\n            }\n            return this.mind.get_node(node);\n        },\n\n        add_node: function (parent_node, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_parent_node = this.get_node(parent_node);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_parent_node);\n                }\n                var node = this.mind.add_node(the_parent_node, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.view.reset_node_custom_style(node);\n                    this.expand_node(the_parent_node);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'add_node', data: [the_parent_node.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_node_before = this.get_node(node_before);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_node_before.parent);\n                }\n                var node = this.mind.insert_node_before(the_node_before, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_before', data: [the_node_before.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_node_after = this.get_node(node_after);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_node_after.parent);\n                }\n                var node = this.mind.insert_node_after(the_node_after, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_after', data: [the_node_after.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.remove_node(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                if (node.isroot) {\n                    logger.error('fail, can not remove root node');\n                    return false;\n                }\n                var nodeid = node.id;\n                var parentid = node.parent.id;\n                var parent_node = this.get_node(parentid);\n                this.view.save_location(parent_node);\n                this.view.remove_node(node);\n                this.mind.remove_node(node);\n                this.layout.layout();\n                this.view.show(false);\n                this.view.restore_location(parent_node);\n                this.invoke_event_handle(jm.event_type.edit, { evt: 'remove_node', data: [nodeid], node: parentid });\n                return true;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return false;\n            }\n        },\n\n        update_node: function (nodeid, topic) {\n            if (this.get_editable()) {\n                if (jm.util.text.is_empty(topic)) {\n                    logger.warn('fail, topic can not be empty');\n                    return;\n                }\n                var node = this.get_node(nodeid);\n                if (!!node) {\n                    if (node.topic === topic) {\n                        logger.info('nothing changed');\n                        this.view.update_node(node);\n                        return;\n                    }\n                    node.topic = topic;\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'update_node', data: [nodeid, topic], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        move_node: function (nodeid, beforeid, parentid, direction) {\n            if (this.get_editable()) {\n                var node = this.get_node(nodeid);\n                var updated_node = this.mind.move_node(node, beforeid, parentid, direction);\n                if (!!updated_node) {\n                    this.view.update_node(updated_node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'move_node', data: [nodeid, beforeid, parentid, direction], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        select_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.select_node(the_node);\n                }\n            }\n            if (!this.layout.is_visible(node)) {\n                return;\n            }\n            this.mind.selected = node;\n            this.view.select_node(node);\n            this.invoke_event_handle(jm.event_type.select, { evt: 'select_node', data: [], node: node.id });\n        },\n\n        get_selected_node: function () {\n            if (!!this.mind) {\n                return this.mind.selected;\n            } else {\n                return null;\n            }\n        },\n\n        select_clear: function () {\n            if (!!this.mind) {\n                this.mind.selected = null;\n                this.view.select_clear();\n            }\n        },\n\n        is_node_visible: function (node) {\n            return this.layout.is_visible(node);\n        },\n\n        find_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var prev = null;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (node.id === ni.id) {\n                            n = prev;\n                        }\n                        prev = ni;\n                    }\n                }\n            } else {\n                n = this.mind.get_node_before(node);\n            }\n            return n;\n        },\n\n        find_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var getthis = false;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (getthis) {\n                            n = ni;\n                            break;\n                        }\n                        if (node.id === ni.id) {\n                            getthis = true;\n                        }\n                    }\n                }\n            } else {\n                n = this.mind.get_node_after(node);\n            }\n            return n;\n        },\n\n        set_node_color: function (nodeid, bgcolor, fgcolor) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!bgcolor) {\n                        node.data['background-color'] = bgcolor;\n                    }\n                    if (!!fgcolor) {\n                        node.data['foreground-color'] = fgcolor;\n                    }\n                    this.view.reset_node_custom_style(node);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_font_style: function (nodeid, size, weight, style) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!size) {\n                        node.data['font-size'] = size;\n                    }\n                    if (!!weight) {\n                        node.data['font-weight'] = weight;\n                    }\n                    if (!!style) {\n                        node.data['font-style'] = style;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_image: function (nodeid, image, width, height, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!image) {\n                        node.data['background-image'] = image;\n                    }\n                    if (!!width) {\n                        node.data['width'] = width;\n                    }\n                    if (!!height) {\n                        node.data['height'] = height;\n                    }\n                    if (!!rotation) {\n                        node.data['background-rotation'] = rotation;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_rotation: function (nodeid, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!node.data['background-image']) {\n                        logger.error('fail, only can change rotation angle of node with background image');\n                        return null;\n                    }\n                    node.data['background-rotation'] = rotation;\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        resize: function () {\n            this.view.resize();\n        },\n\n        // callback(type ,data)\n        add_event_listener: function (callback) {\n            if (typeof callback === 'function') {\n                this.event_handles.push(callback);\n            }\n        },\n\n        clear_event_listener: function () {\n            this.event_handles = [];\n        },\n\n        invoke_event_handle: function (type, data) {\n            var j = this;\n            $w.setTimeout(function () {\n                j._invoke_event_handle(type, data);\n            }, 0);\n        },\n\n        _invoke_event_handle: function (type, data) {\n            var l = this.event_handles.length;\n            for (var i = 0; i < l; i++) {\n                this.event_handles[i](type, data);\n            }\n        },\n\n    };\n\n    // ============= data provider =============================================\n\n    jm.data_provider = function (jm) {\n        this.jm = jm;\n    };\n\n    jm.data_provider.prototype = {\n        init: function () {\n            logger.debug('data.init');\n        },\n\n        reset: function () {\n            logger.debug('data.reset');\n        },\n\n        load: function (mind_data) {\n            var df = null;\n            var mind = null;\n            if (typeof mind_data === 'object') {\n                if (!!mind_data.format) {\n                    df = mind_data.format;\n                } else {\n                    df = 'node_tree';\n                }\n            } else {\n                df = 'freemind';\n            }\n\n            if (df == 'node_array') {\n                mind = jm.format.node_array.get_mind(mind_data);\n            } else if (df == 'node_tree') {\n                mind = jm.format.node_tree.get_mind(mind_data);\n            } else if (df == 'freemind') {\n                mind = jm.format.freemind.get_mind(mind_data);\n            } else {\n                logger.warn('unsupported format');\n            }\n            return mind;\n        },\n\n        get_data: function (data_format) {\n            var data = null;\n            if (data_format == 'node_array') {\n                data = jm.format.node_array.get_data(this.jm.mind);\n            } else if (data_format == 'node_tree') {\n                data = jm.format.node_tree.get_data(this.jm.mind);\n            } else if (data_format == 'freemind') {\n                data = jm.format.freemind.get_data(this.jm.mind);\n            } else {\n                logger.error('unsupported ' + data_format + ' format');\n            }\n            return data;\n        },\n    };\n\n    // ============= layout provider ===========================================\n\n    jm.layout_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.isside = (this.opts.mode == 'side');\n        this.bounds = null;\n\n        this.cache_valid = false;\n    };\n\n    jm.layout_provider.prototype = {\n        init: function () {\n            logger.debug('layout.init');\n        },\n\n        reset: function () {\n            logger.debug('layout.reset');\n            this.bounds = { n: 0, s: 0, w: 0, e: 0 };\n        },\n\n        calculate_next_child_direction: function (node) {\n            if (this.isside) {\n                return jm.direction.right;\n            }\n            var children = node.children || [];\n            var children_len = children.length;\n            var r = 0;\n            for (var i = 0; i < children_len; i++) { if (children[i].direction === jm.direction.left) { r--; } else { r++; } }\n            return (children_len > 1 && r > 0) ? jm.direction.left : jm.direction.right;\n        },\n\n        layout: function () {\n            logger.debug('layout.layout');\n            this.layout_direction();\n            this.layout_offset();\n        },\n\n        layout_direction: function () {\n            this._layout_direction_root();\n        },\n\n        _layout_direction_root: function () {\n            var node = this.jm.mind.root;\n            // logger.debug(node);\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n            layout_data.direction = jm.direction.center;\n            layout_data.side_index = 0;\n            if (this.isside) {\n                var i = children_count;\n                while (i--) {\n                    this._layout_direction_side(children[i], jm.direction.right, i);\n                }\n            } else {\n                var i = children_count;\n                var subnode = null;\n                while (i--) {\n                    subnode = children[i];\n                    if (subnode.direction == jm.direction.left) {\n                        this._layout_direction_side(subnode, jm.direction.left, i);\n                    } else {\n                        this._layout_direction_side(subnode, jm.direction.right, i);\n                    }\n                }\n                /*\n                var boundary = Math.ceil(children_count/2);\n                var i = children_count;\n                while(i--){\n                    if(i>=boundary){\n                        this._layout_direction_side(children[i],jm.direction.left, children_count-i-1);\n                    }else{\n                        this._layout_direction_side(children[i],jm.direction.right, i);\n                    }\n                }*/\n\n            }\n        },\n\n        _layout_direction_side: function (node, direction, side_index) {\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n\n            layout_data.direction = direction;\n            layout_data.side_index = side_index;\n            var i = children_count;\n            while (i--) {\n                this._layout_direction_side(children[i], direction, i);\n            }\n        },\n\n        layout_offset: function () {\n            var node = this.jm.mind.root;\n            var layout_data = node._data.layout;\n            layout_data.offset_x = 0;\n            layout_data.offset_y = 0;\n            layout_data.outer_height = 0;\n            var children = node.children;\n            var i = children.length;\n            var left_nodes = [];\n            var right_nodes = [];\n            var subnode = null;\n            while (i--) {\n                subnode = children[i];\n                if (subnode._data.layout.direction == jm.direction.right) {\n                    right_nodes.unshift(subnode);\n                } else {\n                    left_nodes.unshift(subnode);\n                }\n            }\n            layout_data.left_nodes = left_nodes;\n            layout_data.right_nodes = right_nodes;\n            layout_data.outer_height_left = this._layout_offset_subnodes(left_nodes);\n            layout_data.outer_height_right = this._layout_offset_subnodes(right_nodes);\n            this.bounds.e = node._data.view.width / 2;\n            this.bounds.w = 0 - this.bounds.e;\n            //logger.debug(this.bounds.w);\n            this.bounds.n = 0;\n            this.bounds.s = Math.max(layout_data.outer_height_left, layout_data.outer_height_right);\n        },\n\n        // layout both the x and y axis\n        _layout_offset_subnodes: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                    this.set_visible(node.children, false);\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n                if (node.children.length > 1) {\n                    node_outer_height += this.opts.cousin_space;\n                }\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                layout_data.offset_x = this.opts.hspace * layout_data.direction + pd.view.width * (pd.layout.direction + layout_data.direction) / 2;\n                if (!node.parent.isroot) {\n                    layout_data.offset_x += this.opts.pspace * layout_data.direction;\n                }\n\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n            }\n            return total_height;\n        },\n\n        // layout the y axis only, for collapse/expand a node\n        _layout_offset_subnodes_height: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes_height(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n                if (node.children.length > 1) {\n                    node_outer_height += this.opts.cousin_space;\n                }\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n                //logger.debug(node.topic);\n                //logger.debug(node._data.layout.offset_y);\n            }\n            return total_height;\n        },\n\n        get_node_offset: function (node) {\n            var layout_data = node._data.layout;\n            var offset_cache = null;\n            if (('_offset_' in layout_data) && this.cache_valid) {\n                offset_cache = layout_data._offset_;\n            } else {\n                offset_cache = { x: -1, y: -1 };\n                layout_data._offset_ = offset_cache;\n            }\n            if (offset_cache.x == -1 || offset_cache.y == -1) {\n                var x = layout_data.offset_x;\n                var y = layout_data.offset_y;\n                if (!node.isroot) {\n                    var offset_p = this.get_node_offset(node.parent);\n                    x += offset_p.x;\n                    y += offset_p.y;\n                }\n                offset_cache.x = x;\n                offset_cache.y = y;\n            }\n            return offset_cache;\n        },\n\n        get_node_point: function (node) {\n            var view_data = node._data.view;\n            var offset_p = this.get_node_offset(node);\n            //logger.debug(offset_p);\n            var p = {};\n            p.x = offset_p.x + view_data.width * (node._data.layout.direction - 1) / 2;\n            p.y = offset_p.y - view_data.height / 2;\n            //logger.debug(p);\n            return p;\n        },\n\n        get_node_point_in: function (node) {\n            var p = this.get_node_offset(node);\n            return p;\n        },\n\n        get_node_point_out: function (node) {\n            var layout_data = node._data.layout;\n            var pout_cache = null;\n            if (('_pout_' in layout_data) && this.cache_valid) {\n                pout_cache = layout_data._pout_;\n            } else {\n                pout_cache = { x: -1, y: -1 };\n                layout_data._pout_ = pout_cache;\n            }\n            if (pout_cache.x == -1 || pout_cache.y == -1) {\n                if (node.isroot) {\n                    pout_cache.x = 0;\n                    pout_cache.y = 0;\n                } else {\n                    var view_data = node._data.view;\n                    var offset_p = this.get_node_offset(node);\n                    pout_cache.x = offset_p.x + (view_data.width + this.opts.pspace) * node._data.layout.direction;\n                    pout_cache.y = offset_p.y;\n                    //logger.debug('pout');\n                    //logger.debug(pout_cache);\n                }\n            }\n            return pout_cache;\n        },\n\n        get_expander_point: function (node) {\n            var p = this.get_node_point_out(node);\n            var ex_p = {};\n            if (node._data.layout.direction == jm.direction.right) {\n                ex_p.x = p.x - this.opts.pspace;\n            } else {\n                ex_p.x = p.x;\n            }\n            ex_p.y = p.y - Math.ceil(this.opts.pspace / 2);\n            return ex_p;\n        },\n\n        get_min_size: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pout = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                pout = this.get_node_point_out(node);\n                if (pout.x > this.bounds.e) { this.bounds.e = pout.x; }\n                if (pout.x < this.bounds.w) { this.bounds.w = pout.x; }\n            }\n            return {\n                w: this.bounds.e - this.bounds.w,\n                h: this.bounds.s - this.bounds.n\n            }\n        },\n\n        toggle_node: function (node) {\n            if (node.isroot) {\n                return;\n            }\n            if (node.expanded) {\n                this.collapse_node(node);\n            } else {\n                this.expand_node(node);\n            }\n        },\n\n        expand_node: function (node) {\n            node.expanded = true;\n            this.part_layout(node);\n            this.set_visible(node.children, true);\n            this.jm.invoke_event_handle(jm.event_type.show, { evt: 'expand_node', data: [], node: node.id });\n        },\n\n        collapse_node: function (node) {\n            node.expanded = false;\n            this.part_layout(node);\n            this.set_visible(node.children, false);\n            this.jm.invoke_event_handle(jm.event_type.show, { evt: 'collapse_node', data: [], node: node.id });\n        },\n\n        expand_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!node.expanded) {\n                    node.expanded = true;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        collapse_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (node.expanded && !node.isroot) {\n                    node.expanded = false;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        expand_to_depth: function (target_depth, curr_nodes, curr_depth) {\n            if (target_depth < 1) { return; }\n            var nodes = curr_nodes || this.jm.mind.root.children;\n            var depth = curr_depth || 1;\n            var i = nodes.length;\n            var node = null;\n            while (i--) {\n                node = nodes[i];\n                if (depth < target_depth) {\n                    if (!node.expanded) {\n                        this.expand_node(node);\n                    }\n                    this.expand_to_depth(target_depth, node.children, depth + 1);\n                }\n                if (depth == target_depth) {\n                    if (node.expanded) {\n                        this.collapse_node(node);\n                    }\n                }\n            }\n        },\n\n        part_layout: function (node) {\n            var root = this.jm.mind.root;\n            if (!!root) {\n                var root_layout_data = root._data.layout;\n                if (node.isroot) {\n                    root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                } else {\n                    if (node._data.layout.direction == jm.direction.right) {\n                        root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    } else {\n                        root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                    }\n                }\n                this.bounds.s = Math.max(root_layout_data.outer_height_left, root_layout_data.outer_height_right);\n                this.cache_valid = false;\n            } else {\n                logger.warn('can not found root node');\n            }\n        },\n\n        set_visible: function (nodes, visible) {\n            var i = nodes.length;\n            var node = null;\n            var layout_data = null;\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (node.expanded) {\n                    this.set_visible(node.children, visible);\n                } else {\n                    this.set_visible(node.children, false);\n                }\n                if (!node.isroot) {\n                    node._data.layout.visible = visible;\n                }\n            }\n        },\n\n        is_expand: function (node) {\n            return node.expanded;\n        },\n\n        is_visible: function (node) {\n            var layout_data = node._data.layout;\n            if (('visible' in layout_data) && !layout_data.visible) {\n                return false;\n            } else {\n                return true;\n            }\n        }\n    };\n\n    jm.graph_canvas = function (view) {\n        this.opts = view.opts;\n        this.e_canvas = $c('canvas');\n        this.e_canvas.className = 'jsmind';\n        this.canvas_ctx = this.e_canvas.getContext('2d');\n        this.size = { w: 0, h: 0 };\n    };\n\n    jm.graph_canvas.prototype = {\n        element: function () {\n            return this.e_canvas;\n        },\n\n        set_size: function (w, h) {\n            this.size.w = w;\n            this.size.h = h;\n            this.e_canvas.width = w;\n            this.e_canvas.height = h;\n        },\n\n        clear: function () {\n            this.canvas_ctx.clearRect(0, 0, this.size.w, this.size.h);\n        },\n\n        draw_line: function (pout, pin, offset) {\n            var ctx = this.canvas_ctx;\n            ctx.strokeStyle = this.opts.line_color;\n            ctx.lineWidth = this.opts.line_width;\n            ctx.lineCap = 'round';\n\n            this._bezier_to(ctx,\n                pin.x + offset.x,\n                pin.y + offset.y,\n                pout.x + offset.x,\n                pout.y + offset.y);\n        },\n\n        copy_to: function (dest_canvas_ctx, callback) {\n            dest_canvas_ctx.drawImage(this.e_canvas, 0, 0);\n            !!callback && callback();\n        },\n\n        _bezier_to: function (ctx, x1, y1, x2, y2) {\n            ctx.beginPath();\n            ctx.moveTo(x1, y1);\n            ctx.bezierCurveTo(x1 + (x2 - x1) * 2 / 3, y1, x1, y2, x2, y2);\n            ctx.stroke();\n        },\n\n        _line_to: function (ctx, x1, y1, x2, y2) {\n            ctx.beginPath();\n            ctx.moveTo(x1, y1);\n            ctx.lineTo(x2, y2);\n            ctx.stroke();\n        }\n    };\n\n    jm.graph_svg = function (view) {\n        this.view = view;\n        this.opts = view.opts;\n        this.e_svg = jm.graph_svg.c('svg');\n        this.e_svg.setAttribute('class', 'jsmind');\n        this.size = { w: 0, h: 0 };\n        this.lines = [];\n    };\n\n    jm.graph_svg.c = function (tag) {\n        return $d.createElementNS('http://www.w3.org/2000/svg', tag);\n    };\n\n    jm.graph_svg.prototype = {\n        element: function () {\n            return this.e_svg;\n        },\n\n        set_size: function (w, h) {\n            this.size.w = w;\n            this.size.h = h;\n            this.e_svg.setAttribute('width', w);\n            this.e_svg.setAttribute('height', h);\n        },\n\n        clear: function () {\n            var len = this.lines.length;\n            while (len--) {\n                this.e_svg.removeChild(this.lines[len]);\n            }\n            this.lines.length = 0;\n        },\n\n        draw_line: function (pout, pin, offset) {\n            var line = jm.graph_svg.c('path');\n            line.setAttribute('stroke', this.opts.line_color);\n            line.setAttribute('stroke-width', this.opts.line_width);\n            line.setAttribute('fill', 'transparent');\n            this.lines.push(line);\n            this.e_svg.appendChild(line);\n            this._bezier_to(line, pin.x + offset.x, pin.y + offset.y, pout.x + offset.x, pout.y + offset.y);\n        },\n\n        copy_to: function (dest_canvas_ctx, callback) {\n            var img = new Image();\n            img.onload = function () {\n                dest_canvas_ctx.drawImage(img, 0, 0);\n                !!callback && callback();\n            }\n            img.src = 'data:image/svg+xml;base64,' + btoa(new XMLSerializer().serializeToString(this.e_svg));\n        },\n\n        _bezier_to: function (path, x1, y1, x2, y2) {\n            path.setAttribute('d', 'M' + x1 + ' ' + y1 + ' C ' + (x1 + (x2 - x1) * 2 / 3) + ' ' + y1 + ', ' + x1 + ' ' + y2 + ', ' + x2 + ' ' + y2);\n        },\n\n        _line_to: function (path, x1, y1, x2, y2) {\n            path.setAttribute('d', 'M ' + x1 + ' ' + y1 + ' L ' + x2 + ' ' + y2);\n        }\n    };\n\n    // view provider\n    jm.view_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.layout = jm.layout;\n\n        this.container = null;\n        this.e_panel = null;\n        this.e_nodes = null;\n\n        this.size = { w: 0, h: 0 };\n\n        this.selected_node = null;\n        this.editing_node = null;\n\n        this.graph = null;\n    };\n\n    jm.view_provider.prototype = {\n        init: function () {\n            logger.debug('view.init');\n\n            this.container = $i(this.opts.container) ? this.opts.container : $g(this.opts.container);\n            if (!this.container) {\n                logger.error('the options.view.container was not be found in dom');\n                return;\n            }\n            this.e_panel = $c('div');\n            this.e_nodes = $c('jmnodes');\n            this.e_editor = $c('input');\n\n            this.graph = this.opts.engine.toLowerCase() === 'svg' ? new jm.graph_svg(this) : new jm.graph_canvas(this);\n            this.e_panel.className = 'jsmind-inner jmnode-overflow-' + this.opts.node_overflow;\n            this.e_panel.tabIndex = 1;\n            this.e_panel.appendChild(this.graph.element());\n            this.e_panel.appendChild(this.e_nodes);\n\n            this.e_editor.className = 'jsmind-editor';\n            this.e_editor.type = 'text';\n\n            this.actualZoom = 1;\n            this.zoomStep = 0.1;\n            this.minZoom = 0.5;\n            this.maxZoom = 2;\n\n            var v = this;\n            jm.util.dom.add_event(this.e_editor, 'keydown', function (e) {\n                var evt = e || event;\n                if (evt.keyCode == 13) { v.edit_node_end(); evt.stopPropagation(); }\n            });\n            jm.util.dom.add_event(this.e_editor, 'blur', function (e) {\n                v.edit_node_end();\n            });\n\n            this.container.appendChild(this.e_panel);\n\n            // Used to avoid dragging, while editing node.\n            this.dragging_enabled = true\n\n            this.draggable_canvas()\n        },\n\n        add_event: function (obj, event_name, event_handle) {\n            jm.util.dom.add_event(this.e_nodes, event_name, function (e) {\n                var evt = e || event;\n                event_handle.call(obj, evt);\n            });\n        },\n\n        get_binded_nodeid: function (element) {\n            if (element == null) {\n                return null;\n            }\n            var tagName = element.tagName.toLowerCase();\n            if (tagName == 'jmnode' || tagName == 'jmexpander') {\n                return element.getAttribute('nodeid');\n            } else if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n                return null;\n            } else {\n                return this.get_binded_nodeid(element.parentElement);\n            }\n        },\n\n        is_node: function (element) {\n            if (element == null) {\n                return false;\n            }\n            var tagName = element.tagName.toLowerCase();\n            if (tagName == 'jmnode') {\n                return true;\n            } else if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n                return false;\n            } else {\n                return this.is_node(element.parentElement);\n            }\n        },\n\n        is_expander: function (element) {\n            return (element.tagName.toLowerCase() == 'jmexpander');\n        },\n\n        reset: function () {\n            logger.debug('view.reset');\n            this.selected_node = null;\n            this.clear_lines();\n            this.clear_nodes();\n            this.reset_theme();\n        },\n\n        reset_theme: function () {\n            var theme_name = this.jm.options.theme;\n            if (!!theme_name) {\n                this.e_nodes.className = 'theme-' + theme_name;\n            } else {\n                this.e_nodes.className = '';\n            }\n        },\n\n        reset_custom_style: function () {\n            var nodes = this.jm.mind.nodes;\n            for (var nodeid in nodes) {\n                this.reset_node_custom_style(nodes[nodeid]);\n            }\n        },\n\n        load: function () {\n            logger.debug('view.load');\n            this.init_nodes();\n        },\n\n        expand_size: function () {\n            var min_size = this.layout.get_min_size();\n            var min_width = min_size.w + this.opts.hmargin * 2;\n            var min_height = min_size.h + this.opts.vmargin * 2;\n            var client_w = this.e_panel.clientWidth;\n            var client_h = this.e_panel.clientHeight;\n            if (client_w < min_width) { client_w = min_width; }\n            if (client_h < min_height) { client_h = min_height; }\n            this.size.w = client_w;\n            this.size.h = client_h;\n        },\n\n        init_nodes_size: function (node) {\n            var view_data = node._data.view;\n            view_data.width = view_data.element.clientWidth;\n            view_data.height = view_data.element.clientHeight;\n        },\n\n        init_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var doc_frag = $d.createDocumentFragment();\n            for (var nodeid in nodes) {\n                this.create_node_element(nodes[nodeid], doc_frag);\n            }\n            this.e_nodes.appendChild(doc_frag);\n            for (var nodeid in nodes) {\n                this.init_nodes_size(nodes[nodeid]);\n            }\n        },\n\n        add_node: function (node) {\n            this.create_node_element(node, this.e_nodes);\n            this.init_nodes_size(node);\n        },\n\n        create_node_element: function (node, parent_node) {\n            var view_data = null;\n            if ('view' in node._data) {\n                view_data = node._data.view;\n            } else {\n                view_data = {};\n                node._data.view = view_data;\n            }\n\n            var d = $c('jmnode');\n            if (node.isroot) {\n                d.className = 'root';\n            } else {\n                var d_e = $c('jmexpander');\n                $t(d_e, '-');\n                d_e.setAttribute('nodeid', node.id);\n                d_e.style.visibility = 'hidden';\n                parent_node.appendChild(d_e);\n                view_data.expander = d_e;\n            }\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(d, node.topic);\n                } else {\n                    $t(d, node.topic);\n                }\n            }\n            d.setAttribute('nodeid', node.id);\n            d.style.visibility = 'hidden';\n            this._reset_node_custom_style(d, node.data);\n\n            parent_node.appendChild(d);\n            view_data.element = d;\n        },\n\n        remove_node: function (node) {\n            if (this.selected_node != null && this.selected_node.id == node.id) {\n                this.selected_node = null;\n            }\n            if (this.editing_node != null && this.editing_node.id == node.id) {\n                node._data.view.element.removeChild(this.e_editor);\n                this.editing_node = null;\n            }\n            var children = node.children;\n            var i = children.length;\n            while (i--) {\n                this.remove_node(children[i]);\n            }\n            if (node._data.view) {\n                var element = node._data.view.element;\n                var expander = node._data.view.expander;\n                this.e_nodes.removeChild(element);\n                this.e_nodes.removeChild(expander);\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n        },\n\n        update_node: function (node) {\n            var view_data = node._data.view;\n            var element = view_data.element;\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(element, node.topic);\n                } else {\n                    $t(element, node.topic);\n                }\n            }\n            if (this.layout.is_visible(node)) {\n                view_data.width = element.clientWidth;\n                view_data.height = element.clientHeight;\n            } else {\n                let origin_style = element.getAttribute('style');\n                element.style = 'visibility: visible; left:0; top:0;';\n                view_data.width = element.clientWidth;\n                view_data.height = element.clientHeight;\n                element.style = origin_style;\n            }\n        },\n\n        select_node: function (node) {\n            if (!!this.selected_node) {\n                this.selected_node._data.view.element.className =\n                    this.selected_node._data.view.element.className.replace(/\\s*selected\\b/i, '');\n                this.reset_node_custom_style(this.selected_node);\n            }\n            if (!!node) {\n                this.selected_node = node;\n                node._data.view.element.className += ' selected';\n                this.clear_node_custom_style(node);\n            }\n        },\n\n        select_clear: function () {\n            this.select_node(null);\n        },\n\n        get_editing_node: function () {\n            return this.editing_node;\n        },\n\n        is_editing: function () {\n            return (!!this.editing_node);\n        },\n\n        edit_node_begin: function (node) {\n            if (!node.topic) {\n                logger.warn(\"don't edit image nodes\");\n                return;\n            }\n            if (this.editing_node != null) {\n                this.edit_node_end();\n            }\n            this.editing_node = node;\n            var view_data = node._data.view;\n            var element = view_data.element;\n            var topic = node.topic;\n            var ncs = getComputedStyle(element);\n            this.e_editor.value = topic;\n            this.e_editor.style.width = (element.clientWidth - parseInt(ncs.getPropertyValue('padding-left')) - parseInt(ncs.getPropertyValue('padding-right'))) + 'px';\n            element.innerHTML = '';\n            element.appendChild(this.e_editor);\n            element.style.zIndex = 5;\n            this.e_editor.focus();\n            this.e_editor.select();\n        },\n\n        edit_node_end: function () {\n            if (this.editing_node != null) {\n                var node = this.editing_node;\n                this.editing_node = null;\n                var view_data = node._data.view;\n                var element = view_data.element;\n                var topic = this.e_editor.value;\n                element.style.zIndex = 'auto';\n                element.removeChild(this.e_editor);\n                if (jm.util.text.is_empty(topic) || node.topic === topic) {\n                    if (this.opts.support_html) {\n                        $h(element, node.topic);\n                    } else {\n                        $t(element, node.topic);\n                    }\n                } else {\n                    this.jm.update_node(node.id, topic);\n                }\n            }\n            this.e_panel.focus();\n        },\n\n        get_view_offset: function () {\n            var bounds = this.layout.bounds;\n            var _x = (this.size.w - bounds.e - bounds.w) / 2;\n            var _y = this.size.h / 2;\n            return { x: _x, y: _y };\n        },\n\n        resize: function () {\n            this.graph.set_size(1, 1);\n            this.e_nodes.style.width = '1px';\n            this.e_nodes.style.height = '1px';\n\n            this.expand_size();\n            this._show();\n        },\n\n        _show: function () {\n            this.graph.set_size(this.size.w, this.size.h);\n            this.e_nodes.style.width = this.size.w + 'px';\n            this.e_nodes.style.height = this.size.h + 'px';\n            this.show_nodes();\n            this.show_lines();\n            //this.layout.cache_valid = true;\n            this.jm.invoke_event_handle(jm.event_type.resize, { data: [] });\n        },\n\n        zoomIn: function () {\n            return this.setZoom(this.actualZoom + this.zoomStep);\n        },\n\n        zoomOut: function () {\n            return this.setZoom(this.actualZoom - this.zoomStep);\n        },\n\n        setZoom: function (zoom) {\n            if ((zoom < this.minZoom) || (zoom > this.maxZoom)) {\n                return false;\n            }\n            this.actualZoom = zoom;\n            for (var i = 0; i < this.e_panel.children.length; i++) {\n                this.e_panel.children[i].style.zoom = zoom;\n            };\n            this.show(true);\n            return true;\n\n        },\n\n        _center_root: function () {\n            // center root node\n            var outer_w = this.e_panel.clientWidth;\n            var outer_h = this.e_panel.clientHeight;\n            if (this.size.w > outer_w) {\n                var _offset = this.get_view_offset();\n                this.e_panel.scrollLeft = _offset.x * this.actualZoom - outer_w / 2;\n            }\n            if (this.size.h > outer_h) {\n                this.e_panel.scrollTop = (this.size.h * this.actualZoom - outer_h) / 2;\n            }\n        },\n\n        show: function (keep_center) {\n            logger.debug('view.show');\n            this.expand_size();\n            this._show();\n            if (!!keep_center) {\n                this._center_root();\n            }\n        },\n\n        relayout: function () {\n            this.expand_size();\n            this._show();\n        },\n\n        save_location: function (node) {\n            var vd = node._data.view;\n            vd._saved_location = {\n                x: parseInt(vd.element.style.left) - this.e_panel.scrollLeft,\n                y: parseInt(vd.element.style.top) - this.e_panel.scrollTop,\n            };\n        },\n\n        restore_location: function (node) {\n            var vd = node._data.view;\n            this.e_panel.scrollLeft = parseInt(vd.element.style.left) - vd._saved_location.x;\n            this.e_panel.scrollTop = parseInt(vd.element.style.top) - vd._saved_location.y;\n        },\n\n        clear_nodes: function () {\n            var mind = this.jm.mind;\n            if (mind == null) {\n                return;\n            }\n            var nodes = mind.nodes;\n            var node = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n            this.e_nodes.innerHTML = '';\n        },\n\n        show_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var node_element = null;\n            var expander = null;\n            var p = null;\n            var p_expander = null;\n            var expander_text = '-';\n            var view_data = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                view_data = node._data.view;\n                node_element = view_data.element;\n                expander = view_data.expander;\n                if (!this.layout.is_visible(node)) {\n                    node_element.style.display = 'none';\n                    expander.style.display = 'none';\n                    continue;\n                }\n                this.reset_node_custom_style(node);\n                p = this.layout.get_node_point(node);\n                view_data.abs_x = _offset.x + p.x;\n                view_data.abs_y = _offset.y + p.y;\n                node_element.style.left = (_offset.x + p.x) + 'px';\n                node_element.style.top = (_offset.y + p.y) + 'px';\n                node_element.style.display = '';\n                node_element.style.visibility = 'visible';\n                if (!node.isroot && node.children.length > 0) {\n                    expander_text = node.expanded ? '-' : '+';\n                    p_expander = this.layout.get_expander_point(node);\n                    expander.style.left = (_offset.x + p_expander.x) + 'px';\n                    expander.style.top = (_offset.y + p_expander.y) + 'px';\n                    expander.style.display = '';\n                    expander.style.visibility = 'visible';\n                    $t(expander, expander_text);\n                }\n                // hide expander while all children have been removed\n                if (!node.isroot && node.children.length == 0) {\n                    expander.style.display = 'none';\n                    expander.style.visibility = 'hidden';\n                }\n            }\n        },\n\n        reset_node_custom_style: function (node) {\n            this._reset_node_custom_style(node._data.view.element, node.data);\n        },\n\n        _reset_node_custom_style: function (node_element, node_data) {\n            if ('background-color' in node_data) {\n                node_element.style.backgroundColor = node_data['background-color'];\n            }\n            if ('foreground-color' in node_data) {\n                node_element.style.color = node_data['foreground-color'];\n            }\n            if ('width' in node_data) {\n                node_element.style.width = node_data['width'] + 'px';\n            }\n            if ('height' in node_data) {\n                node_element.style.height = node_data['height'] + 'px';\n            }\n            if ('font-size' in node_data) {\n                node_element.style.fontSize = node_data['font-size'] + 'px';\n            }\n            if ('font-weight' in node_data) {\n                node_element.style.fontWeight = node_data['font-weight'];\n            }\n            if ('font-style' in node_data) {\n                node_element.style.fontStyle = node_data['font-style'];\n            }\n            if ('background-image' in node_data) {\n                var backgroundImage = node_data['background-image'];\n                if (backgroundImage.startsWith('data') && node_data['width'] && node_data['height']) {\n                    var img = new Image();\n\n                    img.onload = function () {\n                        var c = $c('canvas');\n                        c.width = node_element.clientWidth;\n                        c.height = node_element.clientHeight;\n                        var img = this;\n                        if (c.getContext) {\n                            var ctx = c.getContext('2d');\n                            ctx.drawImage(img, 2, 2, node_element.clientWidth, node_element.clientHeight);\n                            var scaledImageData = c.toDataURL();\n                            node_element.style.backgroundImage = 'url(' + scaledImageData + ')';\n                        }\n                    };\n                    img.src = backgroundImage;\n\n                } else {\n                    node_element.style.backgroundImage = 'url(' + backgroundImage + ')';\n                }\n                node_element.style.backgroundSize = '99%';\n\n                if ('background-rotation' in node_data) {\n                    node_element.style.transform = 'rotate(' + node_data['background-rotation'] + 'deg)';\n                }\n            }\n        },\n\n        clear_node_custom_style: function (node) {\n            var node_element = node._data.view.element;\n            node_element.style.backgroundColor = \"\";\n            node_element.style.color = \"\";\n        },\n\n        clear_lines: function () {\n            this.graph.clear();\n        },\n\n        show_lines: function () {\n            this.clear_lines();\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pin = null;\n            var pout = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!!node.isroot) { continue; }\n                if (('visible' in node._data.layout) && !node._data.layout.visible) { continue; }\n                pin = this.layout.get_node_point_in(node);\n                pout = this.layout.get_node_point_out(node.parent);\n                this.graph.draw_line(pout, pin, _offset);\n            }\n        },\n\n        // Drag the whole mind map with your mouse (usefull when it's larger that the container).\n        draggable_canvas: function () {\n            // If draggable option is true.\n            if (this.opts.draggable) {\n                // Dragging disabled by default.\n                let dragging = false\n                let x, y\n                if (this.opts.hide_scrollbars_when_draggable) {\n                    // Avoid scrollbars when mind map is larger than the container (e_panel = id jsmind-inner)\n                    this.e_panel.style = 'overflow: hidden'\n                }\n                // Move the whole mind map with mouse moves, while button is down.\n                jm.util.dom.add_event(this.container, 'mousedown', (eventDown) => {\n                    dragging = true\n                    // Record current mouse position.\n                    x = eventDown.clientX\n                    y = eventDown.clientY\n                })\n                // Stop moving mind map once mouse button is released.\n                jm.util.dom.add_event(this.container, 'mouseup', () => {\n                    dragging = false\n                })\n                // Follow current mouse position and move mind map accordingly.\n                jm.util.dom.add_event(this.container, 'mousemove', (eventMove) => {\n                    if (this.dragging_enabled && dragging) {\n                        this.e_panel.scrollBy(x - eventMove.clientX, y - eventMove.clientY)\n                        // Record new current position.\n                        x = eventMove.clientX\n                        y = eventMove.clientY\n                    }\n                })\n            }\n        },\n\n        get_draggable_canvas: function () {\n            return this.opts.draggable\n        },\n\n        enable_draggable_canvas: function () {\n            this.dragging_enabled = true\n        },\n\n        disable_draggable_canvas: function () {\n            this.dragging_enabled = false\n        },\n\n    };\n\n    // shortcut provider\n    jm.shortcut_provider = function (jm, options) {\n        this.jm = jm;\n        this.opts = options;\n        this.mapping = options.mapping;\n        this.handles = options.handles;\n        this._newid = null;\n        this._mapping = {};\n    };\n\n    jm.shortcut_provider.prototype = {\n        init: function () {\n            jm.util.dom.add_event(this.jm.view.e_panel, 'keydown', this.handler.bind(this));\n\n            this.handles['addchild'] = this.handle_addchild;\n            this.handles['addbrother'] = this.handle_addbrother;\n            this.handles['editnode'] = this.handle_editnode;\n            this.handles['delnode'] = this.handle_delnode;\n            this.handles['toggle'] = this.handle_toggle;\n            this.handles['up'] = this.handle_up;\n            this.handles['down'] = this.handle_down;\n            this.handles['left'] = this.handle_left;\n            this.handles['right'] = this.handle_right;\n\n            for (var handle in this.mapping) {\n                if (!!this.mapping[handle] && (handle in this.handles)) {\n                    var keys = this.mapping[handle];\n                    if(!Array.isArray(keys)){\n                        keys = [keys]\n                    }\n                    for(let key of keys){\n                        this._mapping[key] = this.handles[handle];\n                    }\n                }\n            }\n\n            if (typeof this.opts.id_generator === 'function') {\n                this._newid = this.opts.id_generator;\n            } else {\n                this._newid = jm.util.uuid.newid;\n            }\n        },\n\n        enable_shortcut: function () {\n            this.opts.enable = true;\n        },\n\n        disable_shortcut: function () {\n            this.opts.enable = false;\n        },\n\n        handler: function (e) {\n            if (e.which == 9) { e.preventDefault(); } //prevent tab to change focus in browser\n            if (this.jm.view.is_editing()) { return; }\n            var evt = e || event;\n            if (!this.opts.enable) { return true; }\n            var kc = evt.keyCode + (evt.metaKey << 13) + (evt.ctrlKey << 12) + (evt.altKey << 11) + (evt.shiftKey << 10);\n            if (kc in this._mapping) {\n                this._mapping[kc].call(this, this.jm, e);\n            }\n        },\n\n        handle_addchild: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var nodeid = this._newid();\n                var node = _jm.add_node(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_addbrother: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                var nodeid = this._newid();\n                var node = _jm.insert_node_after(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_editnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.begin_edit(selected_node);\n            }\n        },\n        handle_delnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                _jm.select_node(selected_node.parent);\n                _jm.remove_node(selected_node);\n            }\n        },\n        handle_toggle: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.toggle_node(selected_node.id);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n        handle_up: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var up_node = _jm.find_node_before(selected_node);\n                if (!up_node) {\n                    var np = _jm.find_node_before(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        up_node = np.children[np.children.length - 1];\n                    }\n                }\n                if (!!up_node) {\n                    _jm.select_node(up_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_down: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var down_node = _jm.find_node_after(selected_node);\n                if (!down_node) {\n                    var np = _jm.find_node_after(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        down_node = np.children[0];\n                    }\n                }\n                if (!!down_node) {\n                    _jm.select_node(down_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_left: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.left);\n        },\n        handle_right: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.right);\n        },\n        _handle_direction: function (_jm, e, d) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            var node = null;\n            if (!!selected_node) {\n                if (selected_node.isroot) {\n                    var c = selected_node.children;\n                    var children = [];\n                    for (var i = 0; i < c.length; i++) {\n                        if (c[i].direction === d) {\n                            children.push(i);\n                        }\n                    }\n                    node = c[children[Math.floor((children.length - 1) / 2)]];\n                }\n                else if (selected_node.direction === d) {\n                    var children = selected_node.children;\n                    var childrencount = children.length;\n                    if (childrencount > 0) {\n                        node = children[Math.floor((childrencount - 1) / 2)];\n                    }\n                } else {\n                    node = selected_node.parent;\n                }\n                if (!!node) {\n                    _jm.select_node(node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n    };\n\n\n    // plugin\n    jm.plugin = function (name, init) {\n        this.name = name;\n        this.init = init;\n    };\n\n    jm.plugins = [];\n\n    jm.register_plugin = function (plugin) {\n        if (plugin instanceof jm.plugin) {\n            jm.plugins.push(plugin);\n        }\n    };\n\n    jm.init_plugins = function (sender) {\n        $w.setTimeout(function () {\n            jm._init_plugins(sender);\n        }, 0);\n    };\n\n    jm._init_plugins = function (sender) {\n        var l = jm.plugins.length;\n        var fn_init = null;\n        for (var i = 0; i < l; i++) {\n            fn_init = jm.plugins[i].init;\n            if (typeof fn_init === 'function') {\n                fn_init(sender);\n            }\n        }\n    };\n\n    jm.show = function (options, mind) {\n        logger.warn('`jsMind.show(options, mind)` is deprecated, please use `jm = new jsMind(options); jm.show(mind);` instead')\n        var _jm = new jm(options);\n        _jm.show(mind);\n        return _jm;\n    };\n\n    // export jsmind\n    if (typeof module !== 'undefined' && typeof exports === 'object') {\n        module.exports = jm;\n    } else if (typeof define === 'function' && (define.amd || define.cmd)) {\n        define(function () { return jm; });\n    } else {\n        $w[__name__] = jm;\n    }\n})(typeof window !== 'undefined' ? window : global);\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}