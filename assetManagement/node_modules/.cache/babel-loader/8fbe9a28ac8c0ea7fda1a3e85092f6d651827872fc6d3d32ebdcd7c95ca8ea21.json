{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport dayjs from 'dayjs';\nimport { categoryes } from '../types/types'; //只导入特定的属性，变量\n\nexport default {\n  data() {\n    return {\n      isShow: false,\n      form: {\n        category: '',\n        type: 'expend',\n        amount: 0,\n        date: dayjs().format('MM-DD hh:mm'),\n        remark: '',\n        personnel: []\n      },\n      categoryValue: '',\n      name: '',\n      showInput: false,\n      selectVisible: false\n    };\n  },\n  computed: {\n    options() {\n      const res = [];\n      for (const k of Object.keys(categoryes)) res.push({\n        name: categoryes[k].name,\n        value: k\n      });\n      return res;\n    }\n  },\n  methods: {\n    handleBack() {\n      this.$router.go(-1);\n    },\n    onOptionClick(o) {\n      this.categoryValue = o.value;\n    },\n    handleSelect(p) {\n      const index = this.form.personnel.indexOf(p);\n      if (index === -1) this.form.personnel.push(p);else this.form.personnel.splice(index, 1);\n    },\n    onAddNameClick() {\n      this.showInput = true;\n      this.$nextTick(() => {\n        this.$refs.nameInput.focus();\n      });\n    },\n    handleInputBlur() {\n      if ((this.name.trim() ?? '') === '') return;\n      this.$mainStore.addNewPerson(this.name);\n      this.name = '';\n      this.showInput = false;\n    },\n    add() {\n      if (this.form.amount === 0 || !this.form.category.length || !this.form.date) {\n        this.isShow = true;\n        setTimeout(() => {\n          this.isShow = false;\n        }, 1500);\n        return;\n      }\n      if (this.form.personnel.length === 0) {\n        this.$mainStore.addRecord({\n          id: new Date().getTime(),\n          category: this.categoryValue,\n          amount: this.form.amount,\n          date: this.form.date,\n          type: this.form.type,\n          remark: this.form.remark\n        });\n      } else {\n        this.$mainStore.addMultiUserRecord({\n          id: new Date().getTime(),\n          category: this.categoryValue,\n          amount: this.form.amount,\n          date: this.form.date,\n          type: this.form.type,\n          remark: this.form.remark,\n          personnel: this.form.personnel\n        });\n      }\n      this.$router.go(-1);\n    }\n  }\n};","map":{"version":3,"names":["dayjs","categoryes","data","isShow","form","category","type","amount","date","format","remark","personnel","categoryValue","name","showInput","selectVisible","computed","options","res","k","Object","keys","push","value","methods","handleBack","$router","go","onOptionClick","o","handleSelect","p","index","indexOf","splice","onAddNameClick","$nextTick","$refs","nameInput","focus","handleInputBlur","trim","$mainStore","addNewPerson","add","length","setTimeout","addRecord","id","Date","getTime","addMultiUserRecord"],"sources":["src/views/add.vue"],"sourcesContent":["<template>\n  <div>\n    <Toast :content=\"isShow\" :show=\"isShow\" />\n    <Topbar title=\"添加记录\" :back=\"true\" :finish=\"true\" @on-back=\"handleBack\" @on-finish=\"add\" />\n    <div class=\"type\">\n      <div @click=\"form.type = 'expend'\">\n        支出\n      </div>\n      <div @click=\"form.type = 'income'\">\n        收入\n      </div>\n      <div class=\"active\" :style=\"{ transform: form.type === 'expend' ? 'translateX(0)' : 'translateX(100%)' }\" />\n    </div>\n    <div class=\"form\">\n      <div class=\"form-item\">\n        <m-input v-model=\"form.category\" label=\"分类\" placeholder=\"输入或选择分类\" type=\"checkBox\" :options=\"options\" @on-option-click=\"onOptionClick\" />\n      </div>\n      <div class=\"form-item\">\n        <m-input v-model=\"form.amount\" label=\"金额\" allow-clear placeholder=\"0.00\" type=\"number\">\n          <template v-slot:prefix>\n            <div class=\"symbol\">\n              ¥\n            </div>\n          </template>\n        </m-input>\n      </div>\n      <div class=\"form-item\">\n        <m-input v-model=\"form.date\" label=\"时间\" placeholder=\"选择时间\" type=\"date\" />\n      </div>\n      <div class=\"form-item\">\n        <m-input v-model=\"form.remark\" label=\"备注\" placeholder=\"备注（可选）\" type=\"text\" />\n      </div>\n      <div class=\"form-item\">\n        <div class=\"person\">\n          <div v-for=\"p in form.personnel\" :key=\"p.id\" class=\"item\">\n            {{ p.name }}\n          </div>\n          <button class=\"item add-btn\" @click=\"selectVisible = true\">\n            人员选择\n          </button>\n        </div>\n      </div>\n      <Popup v-model=\"selectVisible\">\n        <div class=\"select-person\">\n          <div v-for=\"p in mainStore.person\" :key=\"p.id\" class=\"person-item\" :class=\"{ selected: form.personnel.includes(p) }\" @click=\"handleSelect(p)\">\n            {{ p.name }}\n          </div>\n          <input v-if=\"showInput\" ref=\"nameInput\" v-model=\"name\" type=\"text\" class=\"person-item\" @blur=\"handleInputBlur\">\n          <button v-if=\"!showInput\" btn @click=\"onAddNameClick\">\n            添加人员 +\n          </button>\n        </div>\n      </Popup>\n    </div>\n  </div>\n</template>\n\n<script>\nimport dayjs from 'dayjs'\nimport {categoryes} from '../types/types'//只导入特定的属性，变量\n\nexport default {\n  data() {\n    return {\n      isShow: false,\n      form: {\n        category: '',\n        type: 'expend',\n        amount: 0,\n        date: dayjs().format('MM-DD hh:mm'),\n        remark: '',\n        personnel: [],\n      },\n      categoryValue: '',\n      name: '',\n      showInput: false,\n      selectVisible: false,\n    };\n  },\n  computed: {\n    options() {\n      const res = [];\n      for (const k of Object.keys(categoryes))\n        res.push({ name: categoryes[k].name, value: k });\n      return res;\n    },\n  },\n  methods: {\n    handleBack() {\n      this.$router.go(-1);\n    },\n    onOptionClick(o) {\n      this.categoryValue = o.value;\n    },\n    handleSelect(p) {\n      const index = this.form.personnel.indexOf(p);\n      if (index === -1)\n        this.form.personnel.push(p);\n      else\n        this.form.personnel.splice(index, 1);\n    },\n    onAddNameClick() {\n      this.showInput = true;\n      this.$nextTick(() => {\n        this.$refs.nameInput.focus();\n      });\n    },\n    handleInputBlur() {\n      if ((this.name.trim() ?? '') === '')\n        return;\n      this.$mainStore.addNewPerson(this.name);\n      this.name = '';\n      this.showInput = false;\n    },\n    add() {\n      if (this.form.amount === 0 || !this.form.category.length || !this.form.date) {\n        this.isShow = true;\n        setTimeout(() => {\n          this.isShow = false;\n        }, 1500);\n        return;\n      }\n      if (this.form.personnel.length === 0) {\n        this.$mainStore.addRecord({\n          id: new Date().getTime(),\n          category: this.categoryValue,\n          amount: this.form.amount,\n          date: this.form.date,\n          type: this.form.type,\n          remark: this.form.remark,\n        });\n      }\n      else {\n        this.$mainStore.addMultiUserRecord({\n          id: new Date().getTime(),\n          category: this.categoryValue,\n          amount: this.form.amount,\n          date: this.form.date,\n          type: this.form.type,\n          remark: this.form.remark,\n          personnel: this.form.personnel,\n        });\n      }\n      this.$router.go(-1);\n    },\n  },\n};\n</script>\n\n\n<style scoped lang=\"less\">\n@import '../styles/common.less';\n@import '../styles/common.css';\n@import '../styles/main.css';\n.type{\n  position: relative;\n  display: flex;\n  border: 1px solid #2333;\n  user-select: none;\n  div{\n    z-index: 2;\n    background-color: transparent;\n    flex: 1;\n    text-align: center;\n    padding: .6rem;\n  }\n  .active{\n    height: 100%;\n    width: 50%;\n    z-index: 1;\n    position: absolute;\n    background-color: @primary-3;\n    border-radius: .4rem;\n    transition: .1s;\n    box-shadow: inset 0 0 6px @primary-1;\n  }\n}\n.form{\n  .form-item{\n    margin: .8rem;\n  }\n\n}\n.person{\n  display: flex;\n  gap: 1rem;\n  flex-wrap: wrap;\n  .item{\n    border-radius: .6rem;\n    border: 1px solid @primary-4;\n    padding: .2rem .6rem;\n  }\n  .add-btn{\n    border: 1px dashed @primary-4;\n  }\n}\n.select-person{\n  padding: 1rem;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  .person-item{\n    width: 4rem;\n    line-height: 2rem;\n    text-align: center;\n    border: #2333 1px solid;\n  }\n  .selected{\n    background-color: @primary-4;\n  }\n}\n</style>\n"],"mappings":";AA0DA,OAAAA,KAAA;AACA,SAAAC,UAAA;;AAEA;EACAC,KAAA;IACA;MACAC,MAAA;MACAC,IAAA;QACAC,QAAA;QACAC,IAAA;QACAC,MAAA;QACAC,IAAA,EAAAR,KAAA,GAAAS,MAAA;QACAC,MAAA;QACAC,SAAA;MACA;MACAC,aAAA;MACAC,IAAA;MACAC,SAAA;MACAC,aAAA;IACA;EACA;EACAC,QAAA;IACAC,QAAA;MACA,MAAAC,GAAA;MACA,WAAAC,CAAA,IAAAC,MAAA,CAAAC,IAAA,CAAApB,UAAA,GACAiB,GAAA,CAAAI,IAAA;QAAAT,IAAA,EAAAZ,UAAA,CAAAkB,CAAA,EAAAN,IAAA;QAAAU,KAAA,EAAAJ;MAAA;MACA,OAAAD,GAAA;IACA;EACA;EACAM,OAAA;IACAC,WAAA;MACA,KAAAC,OAAA,CAAAC,EAAA;IACA;IACAC,cAAAC,CAAA;MACA,KAAAjB,aAAA,GAAAiB,CAAA,CAAAN,KAAA;IACA;IACAO,aAAAC,CAAA;MACA,MAAAC,KAAA,QAAA5B,IAAA,CAAAO,SAAA,CAAAsB,OAAA,CAAAF,CAAA;MACA,IAAAC,KAAA,SACA,KAAA5B,IAAA,CAAAO,SAAA,CAAAW,IAAA,CAAAS,CAAA,OAEA,KAAA3B,IAAA,CAAAO,SAAA,CAAAuB,MAAA,CAAAF,KAAA;IACA;IACAG,eAAA;MACA,KAAArB,SAAA;MACA,KAAAsB,SAAA;QACA,KAAAC,KAAA,CAAAC,SAAA,CAAAC,KAAA;MACA;IACA;IACAC,gBAAA;MACA,UAAA3B,IAAA,CAAA4B,IAAA,kBACA;MACA,KAAAC,UAAA,CAAAC,YAAA,MAAA9B,IAAA;MACA,KAAAA,IAAA;MACA,KAAAC,SAAA;IACA;IACA8B,IAAA;MACA,SAAAxC,IAAA,CAAAG,MAAA,gBAAAH,IAAA,CAAAC,QAAA,CAAAwC,MAAA,UAAAzC,IAAA,CAAAI,IAAA;QACA,KAAAL,MAAA;QACA2C,UAAA;UACA,KAAA3C,MAAA;QACA;QACA;MACA;MACA,SAAAC,IAAA,CAAAO,SAAA,CAAAkC,MAAA;QACA,KAAAH,UAAA,CAAAK,SAAA;UACAC,EAAA,MAAAC,IAAA,GAAAC,OAAA;UACA7C,QAAA,OAAAO,aAAA;UACAL,MAAA,OAAAH,IAAA,CAAAG,MAAA;UACAC,IAAA,OAAAJ,IAAA,CAAAI,IAAA;UACAF,IAAA,OAAAF,IAAA,CAAAE,IAAA;UACAI,MAAA,OAAAN,IAAA,CAAAM;QACA;MACA,OACA;QACA,KAAAgC,UAAA,CAAAS,kBAAA;UACAH,EAAA,MAAAC,IAAA,GAAAC,OAAA;UACA7C,QAAA,OAAAO,aAAA;UACAL,MAAA,OAAAH,IAAA,CAAAG,MAAA;UACAC,IAAA,OAAAJ,IAAA,CAAAI,IAAA;UACAF,IAAA,OAAAF,IAAA,CAAAE,IAAA;UACAI,MAAA,OAAAN,IAAA,CAAAM,MAAA;UACAC,SAAA,OAAAP,IAAA,CAAAO;QACA;MACA;MACA,KAAAe,OAAA,CAAAC,EAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}